/* Visio Web-specific API library */
/* Version: 16.0.10710.30000 */

/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/

/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

/*
* @overview es6-promise - a tiny implementation of Promises/A+.
* @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
* @license   Licensed under MIT license
*            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
* @version   2.3.0
*/

var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),OfficeExtension,OfficeFirstPartyAuth,OfficeCore,Visio;(function(n){var t,i;(function(n){n.OfficeRequire=function(){return null}()})(t=n._Internal||(n._Internal={})),function(n){var t;(function(t){function i(){return function(){"use strict";function vt(n){return typeof n=="function"||typeof n=="object"&&n!==null}function b(n){return typeof n=="function"}function yt(n){return typeof n=="object"&&n!==null}function wt(n){k=n}function bt(n){f=n}function ni(){var t=process.nextTick,n=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&n[1]==="0"&&n[2]==="10"&&(t=setImmediate),function(){t(c)}}function tr(){return function(){pt(c)}}function ti(){var n=0,i=new it(c),t=document.createTextNode("");return i.observe(t,{characterData:!0}),function(){t.data=n=++n%2}}function ii(){var n=new MessageChannel;return n.port1.onmessage=c,function(){n.port2.postMessage(0)}}function ri(){return function(){setTimeout(c,1)}}function c(){for(var t,i,n=0;n<h;n+=2)t=e[n],i=e[n+1],t(i),e[n]=undefined,e[n+1]=undefined;h=0}function l(){}function ui(){return new TypeError("You cannot resolve a promise with itself")}function fi(){return new TypeError("A promises callback cannot return that same promise.")}function ei(n){try{return n.then}catch(t){return y.error=t,y}}function oi(n,t,i,r){try{n.call(t,i,r)}catch(u){return u}}function si(n,i,u){f(function(n){var f=!1,e=oi(u,i,function(t){f||(f=!0,i!==t?v(n,t):r(n,t))},function(i){f||(f=!0,t(n,i))},"Settle: "+(n._label||" unknown promise"));!f&&e&&(f=!0,t(n,e))},n)}function hi(n,i){i._state===a?r(n,i._result):i._state===s?t(n,i._result):p(i,undefined,function(t){v(n,t)},function(i){t(n,i)})}function ci(n,i){if(i.constructor===n.constructor)hi(n,i);else{var u=ei(i);u===y?t(n,y.error):u===undefined?r(n,i):b(u)?si(n,i,u):r(n,i)}}function v(n,i){n===i?t(n,ui()):vt(i)?ci(n,i):r(n,i)}function li(n){n._onerror&&n._onerror(n._result);d(n)}function r(n,t){n._state===o&&(n._result=t,n._state=a,n._subscribers.length!==0&&f(d,n))}function t(n,t){n._state===o&&(n._state=s,n._result=t,f(li,n))}function p(n,t,i,r){var u=n._subscribers,e=u.length;n._onerror=null;u[e]=t;u[e+a]=i;u[e+s]=r;e===0&&n._state&&f(d,n)}function d(n){var i=n._subscribers,e=n._state,r,u,f,t;if(i.length!==0){for(f=n._result,t=0;t<i.length;t+=3)r=i[t],u=i[t+e],r?ft(e,r,u,f):u(f);n._subscribers.length=0}}function ut(){this.error=null}function ai(n,t){try{return n(t)}catch(i){return w.error=i,w}}function ft(n,i,u,f){var c=b(u),e,l,h,y;if(c){if(e=ai(u,f),e===w?(y=!0,l=e.error,e=null):h=!0,i===e){t(i,fi());return}}else e=f,h=!0;i._state!==o||(c&&h?v(i,e):y?t(i,l):n===a?r(i,e):n===s&&t(i,e))}function vi(n,i){try{i(function(t){v(n,t)},function(i){t(n,i)})}catch(r){t(n,r)}}function u(n,i){var u=this;u._instanceConstructor=n;u.promise=new n(l);u._validateInput(i)?(u._input=i,u.length=i.length,u._remaining=i.length,u._init(),u.length===0?r(u.promise,u._result):(u.length=u.length||0,u._enumerate(),u._remaining===0&&r(u.promise,u._result))):t(u.promise,u._validationError())}function yi(n){return new et(this,n).promise}function pi(n){function e(n){v(i,n)}function s(n){t(i,n)}var u=this,i=new u(l),f,r;if(!nt(n))return t(i,new TypeError("You must pass an array to race.")),i;for(f=n.length,r=0;i._state===o&&r<f;r++)p(u.resolve(n[r]),undefined,e,s);return i}function wi(n){var i=this,t;return n&&typeof n=="object"&&n.constructor===i?n:(t=new i(l),v(t,n),t)}function bi(n){var r=this,i=new r(l);return t(i,n),i}function ki(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function di(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}function i(n){this._id=lt++;this._state=undefined;this._result=undefined;this._subscribers=[];l!==n&&(b(n)||ki(),this instanceof i||di(),vi(this,n))}var g,e,rt,w,et,ot,st,ht,ct,lt,at;g=Array.isArray?Array.isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"};var nt=g,h=0,gi={}.toString,pt,k,f=function(n,t){e[h]=n;e[h+1]=t;h+=2;h===2&&(k?k(c):rt())};var kt=typeof window!="undefined"?window:undefined,tt=kt||{},it=tt.MutationObserver||tt.WebKitMutationObserver,dt=typeof process!="undefined"&&{}.toString.call(process)==="[object process]",gt=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";e=new Array(1e3);rt=dt?ni():it?ti():gt?ii():ri();var o=void 0,a=1,s=2,y=new ut;return w=new ut,u.prototype._validateInput=function(n){return nt(n)},u.prototype._validationError=function(){return new n.Error("Array Methods must be provided an Array")},u.prototype._init=function(){this._result=new Array(this.length)},et=u,u.prototype._enumerate=function(){for(var n=this,i=n.length,r=n.promise,u=n._input,t=0;r._state===o&&t<i;t++)n._eachEntry(u[t],t)},u.prototype._eachEntry=function(n,t){var i=this,r=i._instanceConstructor;yt(n)?n.constructor===r&&n._state!==o?(n._onerror=null,i._settledAt(n._state,t,n._result)):i._willSettleAt(r.resolve(n),t):(i._remaining--,i._result[t]=n)},u.prototype._settledAt=function(n,i,u){var f=this,e=f.promise;e._state===o&&(f._remaining--,n===s?t(e,u):f._result[i]=u);f._remaining===0&&r(e,f._result)},u.prototype._willSettleAt=function(n,t){var i=this;p(n,undefined,function(n){i._settledAt(a,t,n)},function(n){i._settledAt(s,t,n)})},ot=yi,st=pi,ht=wi,ct=bi,lt=0,at=i,i.all=ot,i.race=st,i.resolve=ht,i.reject=ct,i._setScheduler=wt,i._setAsap=bt,i._asap=f,i.prototype={constructor:i,then:function(n,t){var u=this,i=u._state,r,e,o;return i===a&&!n||i===s&&!t?this:(r=new this.constructor(l),e=u._result,i?(o=arguments[i-1],f(function(){ft(i,r,o,e)})):p(u,r,n,t),r)},"catch":function(n){return this.then(null,n)}},at}.call(this)}t.Init=i})(t=n.PromiseImpl||(n.PromiseImpl={}))}(t=n._Internal||(n._Internal={})),function(n){function t(){var n=window.navigator.userAgent,t=n.indexOf("Edge/");return t>=0?(n=n.substring(t+5,n.length),n<"14.14393"?!0:!1):!1}function i(){return typeof window=="undefined"&&typeof Promise=="function"?Promise:typeof window!="undefined"&&window.Promise?t()?n.PromiseImpl.Init():window.Promise:n.PromiseImpl.Init()}n.OfficePromise=i()}(t=n._Internal||(n._Internal={}));i=t.OfficePromise;n.Promise=i})(OfficeExtension||(OfficeExtension={})),function(n){function hi(n){w._testReadyImpl=n}function ci(n){w.getGenericEventRegistration()._handleRichApiMessage(n)}var k=function(){function n(){}return n.prototype._resolveRequestUrlAndHeaderInfo=function(){return t._createPromiseFromResult(null)},n.prototype._createRequestExecutorOrNull=function(){return null},Object.defineProperty(n.prototype,"eventRegistration",{get:function(){return null},enumerable:!0,configurable:!0}),n}(),ut,d,r,f,h,a,c,t,it,v,l,et,wt,ot,rt,bt,st,y,p,kt,g,dt,e,ht,ti,u,tt,vt,ct,lt,w,ii,ri,b,ui,yt,at,o,i,fi,pt,ft,s,nt,ei,oi;n.SessionBase=k;ut=function(){function n(){}return n.setCustomSendRequestFunc=function(t){n.s_customSendRequestFunc=t},n.xhrSendRequestFunc=function(n){return t.createPromise(function(i,u){var e=new XMLHttpRequest,o;if(e.open(n.method,n.url),e.onload=function(){var n={statusCode:e.status,headers:t._parseHttpResponseHeaders(e.getAllResponseHeaders()),body:e.responseText};i(n)},e.onerror=function(){u(new r.RuntimeError({code:f.connectionFailure,message:t._getResourceString(h.connectionFailureWithStatus,e.statusText)}))},n.headers)for(o in n.headers)e.setRequestHeader(o,n.headers[o]);e.send(t._getRequestBodyText(n))})},n.sendRequest=function(t){n.validateAndNormalizeRequest(t);var i=n.s_customSendRequestFunc;return i||(i=n.xhrSendRequestFunc),i(t)},n.setCustomSendLocalDocumentRequestFunc=function(t){n.s_customSendLocalDocumentRequestFunc=t},n.sendLocalDocumentRequest=function(t){n.validateAndNormalizeRequest(t);var i;return i=n.s_customSendLocalDocumentRequestFunc||n.officeJsSendLocalDocumentRequestFunc,i(t)},n.officeJsSendLocalDocumentRequestFunc=function(n){n=t._validateLocalDocumentRequest(n);var i=t._buildRequestMessageSafeArray(n);return t.createPromise(function(n,r){OSF.DDA.RichApi.executeRichApiRequestAsync(i,function(i){var r;r=i.status=="succeeded"?{statusCode:c.getResponseStatusCode(i),headers:c.getResponseHeaders(i),body:c.getResponseBody(i)}:c.buildHttpResponseFromOfficeJsError(i.error.code,i.error.message);t.log(JSON.stringify(r));n(r)})})},n.validateAndNormalizeRequest=function(n){if(t.isNullOrUndefined(n))throw r.RuntimeError._createInvalidArgError({argumentName:"request"});t.isNullOrEmptyString(n.method)&&(n.method="GET");n.method=n.method.toUpperCase()},n.logRequest=function(i){if(t._logEnabled){if(t.log("---HTTP Request---"),t.log(i.method+" "+i.url),i.headers)for(var r in i.headers)t.log(r+": "+i.headers[r]);n._logBodyEnabled&&t.log(t._getRequestBodyText(i))}},n.logResponse=function(i){if(t._logEnabled){if(t.log("---HTTP Response---"),t.log(""+i.statusCode),i.headers)for(var r in i.headers)t.log(r+": "+i.headers[r]);n._logBodyEnabled&&t.log(i.body)}},n._logBodyEnabled=!1,n}();n.HttpUtility=ut;d=function(){function n(n){var t=this;this.m_bridge=n;this.m_promiseResolver={};this.m_handlers=[];this.m_bridge.onMessageFromHost=function(n){var i=JSON.parse(n);t.dispatchMessage(i)}}return n.init=function(i){var r,u;if(typeof i=="object"&&i)for(r=new n(i),n.s_instance=r,ut.setCustomSendLocalDocumentRequestFunc(function(i){var u,f,o,e,s;return i=t._validateLocalDocumentRequest(i),u=0,t.isReadonlyRestRequest(i.method)||(u=1),f=i.url.indexOf("?"),f>=0&&(o=i.url.substr(f+1),e=t._parseRequestFlagsFromQueryStringIfAny(o),e>=0&&(u=e)),s={id:n.nextId(),type:1,flags:u,message:i},r.sendMessageToHostAndExpectResponse(s).then(function(n){return n.message})}),u=0;u<n.s_onInitedHandlers.length;u++)n.s_onInitedHandlers[u](r)},Object.defineProperty(n,"instance",{get:function(){return n.s_instance},enumerable:!0,configurable:!0}),n.prototype.sendMessageToHost=function(n){this.m_bridge.sendMessageToHost(JSON.stringify(n))},n.prototype.sendMessageToHostAndExpectResponse=function(n){var i=this,r=t.createPromise(function(t,r){i.m_promiseResolver[n.id]=t});return this.m_bridge.sendMessageToHost(JSON.stringify(n)),r},n.prototype.addHostMessageHandler=function(n){this.m_handlers.push(n)},n.prototype.removeHostMessageHandler=function(n){var t=this.m_handlers.indexOf(n);t>=0&&this.m_handlers.splice(t,1)},n.onInited=function(t){n.s_onInitedHandlers.push(t);n.s_instance&&t(n.s_instance)},n.prototype.dispatchMessage=function(n){var i,t;if(typeof n.id=="number"&&(i=this.m_promiseResolver[n.id],i)){i(n);delete this.m_promiseResolver[n.id];return}for(t=0;t<this.m_handlers.length;t++)this.m_handlers[t](n)},n.nextId=function(){return n.s_nextId++},n.s_onInitedHandlers=[],n.s_nextId=1,n}();n.HostBridge=d;typeof _richApiNativeBridge=="object"&&_richApiNativeBridge&&d.init(_richApiNativeBridge),function(n){var i=function(i){function r(n){var t=i.call(this,typeof n=="string"?n:n.message)||this;return Object.setPrototypeOf(t,r.prototype),t.name="RichApi.Error",typeof n=="string"?t.message=n:(t.code=n.code,t.message=n.message,t.traceMessages=n.traceMessages||[],t.innerError=n.innerError||null,t.debugInfo=t._createDebugInfo(n.debugInfo||{})),t}return __extends(r,i),r.prototype.toString=function(){return this.code+": "+this.message},r.prototype._createDebugInfo=function(t){var i={code:this.code,message:this.message},r;i.toString=function(){return JSON.stringify(this)};for(r in t)i[r]=t[r];return this.innerError&&(i.innerError=this.innerError instanceof n.RuntimeError?this.innerError.debugInfo:this.innerError),i},r._createInvalidArgError=function(i){return new n.RuntimeError({code:f.invalidArgument,message:t.isNullOrEmptyString(i.argumentName)?t._getResourceString(h.invalidArgumentGeneric):t._getResourceString(h.invalidArgument,i.argumentName),debugInfo:i.errorLocation?{errorLocation:i.errorLocation}:{},innerError:i.innerError})},r}(Error);n.RuntimeError=i}(r=n._Internal||(n._Internal={}));n.Error=r.RuntimeError;f=function(){function n(){}return n.apiNotFound="ApiNotFound",n.accessDenied="AccessDenied",n.generalException="GeneralException",n.activityLimitReached="ActivityLimitReached",n.invalidArgument="InvalidArgument",n.connectionFailure="ConnectionFailure",n.timeout="Timeout",n.invalidOrTimedOutSession="InvalidOrTimedOutSession",n.invalidObjectPath="InvalidObjectPath",n.invalidRequestContext="InvalidRequestContext",n.valueNotLoaded="ValueNotLoaded",n}();n.CoreErrorCodes=f;h=function(){function n(){}return n.apiNotFoundDetails="ApiNotFoundDetails",n.connectionFailureWithStatus="ConnectionFailureWithStatus",n.connectionFailureWithDetails="ConnectionFailureWithDetails",n.invalidArgument="InvalidArgument",n.invalidArgumentGeneric="InvalidArgumentGeneric",n.timeout="Timeout",n.invalidOrTimedOutSessionMessage="InvalidOrTimedOutSessionMessage",n.invalidObjectPath="InvalidObjectPath",n.invalidRequestContext="InvalidRequestContext",n.valueNotLoaded="ValueNotLoaded",n}();n.CoreResourceStrings=h;a=function(){function n(){}return n.flags="flags",n.sourceLibHeader="SdkVersion",n.processQuery="ProcessQuery",n.localDocument="http://document.localhost/",n.localDocumentApiPrefix="http://document.localhost/_api/",n}();n.CoreConstants=a;c=function(){function n(){}return n.buildMessageArrayForIRequestExecutor=function(i,r,u,f){var o=JSON.stringify(u.Body),e;return t.log("Request:"),t.log(o),e={},e[a.sourceLibHeader]=f,n.buildRequestMessageSafeArray(i,r,"POST",a.processQuery,e,o)},n.buildResponseOnSuccess=function(n,t){var i={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};return i.Body=JSON.parse(n),i.Headers=t,i},n.buildResponseOnError=function(i,r){var u={ErrorCode:"",ErrorMessage:"",Headers:null,Body:null};return u.ErrorCode=f.generalException,u.ErrorMessage=r,i==n.OfficeJsErrorCode_ooeNoCapability?u.ErrorCode=f.accessDenied:i==n.OfficeJsErrorCode_ooeActivityLimitReached?u.ErrorCode=f.activityLimitReached:i==n.OfficeJsErrorCode_ooeInvalidOrTimedOutSession&&(u.ErrorCode=f.invalidOrTimedOutSession,u.ErrorMessage=t._getResourceString(h.invalidOrTimedOutSessionMessage)),u},n.buildHttpResponseFromOfficeJsError=function(t,i){var u=500,r={};return r.error={},r.error.code=f.generalException,r.error.message=i,t===n.OfficeJsErrorCode_ooeNoCapability?(u=403,r.error.code=f.accessDenied):t===n.OfficeJsErrorCode_ooeActivityLimitReached&&(u=429,r.error.code=f.activityLimitReached),{statusCode:u,headers:{},body:JSON.stringify(r)}},n.buildRequestMessageSafeArray=function(n,t,i,r,u,f){var e=[],o;if(u)for(o in u)e.push(o),e.push(u[o]);var s=0,h="",c="",l="";return[n,i,r,e,f,s,t,h,c,l]},n.getResponseBody=function(t){return n.getResponseBodyFromSafeArray(t.value.data)},n.getResponseHeaders=function(t){return n.getResponseHeadersFromSafeArray(t.value.data)},n.getResponseBodyFromSafeArray=function(n){var t=n[2],i;return typeof t=="string"?t:(i=t,i.join(""))},n.getResponseHeadersFromSafeArray=function(n){var i=n[1],r,t;if(!i)return null;for(r={},t=0;t<i.length-1;t+=2)r[i[t]]=i[t+1];return r},n.getResponseStatusCode=function(t){return n.getResponseStatusCodeFromSafeArray(t.value.data)},n.getResponseStatusCodeFromSafeArray=function(n){return n[0]},n.OfficeJsErrorCode_ooeInvalidOrTimedOutSession=5012,n.OfficeJsErrorCode_ooeActivityLimitReached=5102,n.OfficeJsErrorCode_ooeNoCapability=7e3,n}();n.RichApiMessageUtility=c,function(n){function t(){if(typeof Promise!="undefined")return Promise;if(typeof Office!="undefined"&&Office.Promise)return Office.Promise;if(typeof OfficeExtension!="undefined"&&OfficeExtension.Promise)return OfficeExtension.Promise;throw new n.Error("No Promise implementation found");}n.getPromiseType=t}(r=n._Internal||(n._Internal={}));t=function(){function n(){}return n.log=function(t){n._logEnabled&&typeof console!="undefined"&&console.log&&console.log(t)},n.checkArgumentNull=function(t,i){if(n.isNullOrUndefined(t))throw r.RuntimeError._createInvalidArgError({argumentName:i});},n.isNullOrUndefined=function(n){return n===null?!0:typeof n=="undefined"?!0:!1},n.isUndefined=function(n){return typeof n=="undefined"?!0:!1},n.isNullOrEmptyString=function(n){return n===null?!0:typeof n=="undefined"?!0:n.length==0?!0:!1},n.isPlainJsonObject=function(t){return n.isNullOrUndefined(t)?!1:typeof t!="object"?!1:Object.getPrototypeOf(t)===Object.getPrototypeOf({})},n.trim=function(n){return n.replace(new RegExp("^\\s+|\\s+$","g"),"")},n.caseInsensitiveCompareString=function(t,i){return n.isNullOrUndefined(t)?n.isNullOrUndefined(i):n.isNullOrUndefined(i)?!1:t.toUpperCase()==i.toUpperCase()},n.isReadonlyRestRequest=function(t){return n.caseInsensitiveCompareString(t,"GET")},n._getResourceString=function(t,i){var r,f,u,e;return typeof window!="undefined"&&window.Strings&&window.Strings.OfficeOM&&(f="L_"+t,u=window.Strings.OfficeOM[f],u&&(r=u)),r||(r=n.s_resourceStringValues[t]),r||(r=t),n.isNullOrUndefined(i)||(Array.isArray(i)?(e=i,r=n._formatString(r,e)):r=r.replace("{0}",i)),r},n._formatString=function(n,t){return n.replace(/\{\d\}/g,function(n){var i=parseInt(n.substr(1,n.length-2));if(i<t.length)return t[i];else throw r.RuntimeError._createInvalidArgError({argumentName:"format"});})},Object.defineProperty(n,"Promise",{get:function(){return r.getPromiseType()},enumerable:!0,configurable:!0}),n.createPromise=function(t){return new n.Promise(t)},n._createPromiseFromResult=function(t){return n.createPromise(function(n,i){n(t)})},n._createPromiseFromException=function(t){return n.createPromise(function(n,i){i(t)})},n._createTimeoutPromise=function(t){return n.createPromise(function(n,i){setTimeout(function(){n(null)},t)})},n._createInvalidArgError=function(n){return r.RuntimeError._createInvalidArgError(n)},n._isLocalDocumentUrl=function(t){return n._getLocalDocumentUrlPrefixLength(t)>0},n._getLocalDocumentUrlPrefixLength=function(n){for(var i=["http://document.localhost","https://document.localhost","//document.localhost"],r=n.toLowerCase().trim(),t=0;t<i.length;t++)if(r===i[t])return i[t].length;else if(r.substr(0,i[t].length+1)===i[t]+"/")return i[t].length+1;return 0},n._validateLocalDocumentRequest=function(t){var f=n._getLocalDocumentUrlPrefixLength(t.url),i,u;if(f<=0)throw r.RuntimeError._createInvalidArgError({argumentName:"request"});return i=t.url.substr(f),u=i.toLowerCase(),u==="_api"?i="":u.substr(0,5)==="_api/"&&(i=i.substr(5)),{method:t.method,url:i,headers:t.headers,body:t.body}},n._parseRequestFlagsFromQueryStringIfAny=function(n){for(var i,u,r=n.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0].toLowerCase()===a.flags)return u=parseInt(i[1]),u&127;return-1},n._getRequestBodyText=function(n){var t="";return typeof n.body=="string"?t=n.body:n.body&&typeof n.body=="object"&&(t=JSON.stringify(n.body)),t},n._parseResponseBody=function(t){if(typeof t.body=="string"){var i=n.trim(t.body);return JSON.parse(i)}else return t.body},n._buildRequestMessageSafeArray=function(t){var i=0,r,f,u;return n.isReadonlyRestRequest(t.method)||(i=1),t.url.substr(0,a.processQuery.length).toLowerCase()===a.processQuery.toLowerCase()&&(r=t.url.indexOf("?"),r>0&&(f=t.url.substr(r+1),u=n._parseRequestFlagsFromQueryStringIfAny(f),u>=0&&(i=u))),c.buildRequestMessageSafeArray("",i,t.method,t.url,t.headers,n._getRequestBodyText(t))},n._parseHttpResponseHeaders=function(t){var s={},h,o,r,i,u,f,e;if(!n.isNullOrEmptyString(t))for(h=new RegExp("\r?\n"),o=t.split(h),r=0;r<o.length;r++)i=o[r],i!=null&&(u=i.indexOf(":"),u>0&&(f=i.substr(0,u),e=i.substr(u+1),f=n.trim(f),e=n.trim(e),s[f.toUpperCase()]=e));return s},n._parseErrorResponse=function(t){var i=null,u,e,r;if(n.isPlainJsonObject(t.body))i=t.body;else if(!n.isNullOrEmptyString(t.body)){u=n.trim(t.body);try{i=JSON.parse(u)}catch(o){n.log("Error when parse "+u)}}return!n.isNullOrUndefined(i)&&typeof i=="object"&&i.error?(r=i.error.code,e=n._getResourceString(h.connectionFailureWithDetails,[t.statusCode.toString(),i.error.code,i.error.message])):e=n._getResourceString(h.connectionFailureWithStatus,t.statusCode.toString()),n.isNullOrEmptyString(r)&&(r=f.connectionFailure),{errorCode:r,errorMessage:e}},n._copyHeaders=function(n,t){if(n&&t)for(var i in n)t[i]=n[i]},n.addResourceStringValues=function(t){for(var i in t)n.s_resourceStringValues[i]=t[i]},n._logEnabled=!1,n.s_resourceStringValues={ApiNotFoundDetails:"The method or property {0} is part of the {1} requirement set, which is not available in your version of {2}.",ConnectionFailureWithStatus:"The request failed with status code of {0}.",ConnectionFailureWithDetails:"The request failed with status code of {0}, error code {1} and the following error message: {2}",InvalidArgument:"The argument '{0}' doesn't work for this situation, is missing, or isn't in the right format.",InvalidObjectPath:'The object path \'{0}\' isn\'t working for what you\'re trying to do. If you\'re using the object across multiple "context.sync" calls and outside the sequential execution of a ".run" batch, please use the "context.trackedObjects.add()" and "context.trackedObjects.remove()" methods to manage the object\'s lifetime.',InvalidRequestContext:"Cannot use the object across different request contexts.",Timeout:"The operation has timed out.",ValueNotLoaded:'The value of the result object has not been loaded yet. Before reading the value property, call "context.sync()" on the associated request context.'},n}();n.CoreUtility=t;n._internalConfig={showDisposeInfoInDebugInfo:!1,showInternalApiInDebugInfo:!1,enableEarlyDispose:!0,alwaysPolyfillClientObjectUpdateMethod:!1,alwaysPolyfillClientObjectRetrieveMethod:!1,enableConcurrentFlag:!0,enableUndoableFlag:!0};n.config={extendedErrorLogging:!1};it=function(){function n(n,t){this.m_contextBase=n;this.m_objectPath=t}return Object.defineProperty(n.prototype,"_objectPath",{get:function(){return this.m_objectPath},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_context",{get:function(){return this.m_contextBase},enumerable:!0,configurable:!0}),n}();n.ClientObjectBase=it;v=function(){function n(n,t,i){this.m_actionInfo=n;this.m_operationType=t;this.m_flags=i}return Object.defineProperty(n.prototype,"actionInfo",{get:function(){return this.m_actionInfo},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"operationType",{get:function(){return this.m_operationType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"flags",{get:function(){return this.m_flags},enumerable:!0,configurable:!0}),n}();n.Action=v;l=function(){function i(n,t,i,r,u,f){this.m_objectPathInfo=n;this.m_parentObjectPath=t;this.m_isCollection=i;this.m_isInvalidAfterRequest=r;this.m_isValid=!0;this.m_operationType=u;this.m_flags=f}return Object.defineProperty(i.prototype,"objectPathInfo",{get:function(){return this.m_objectPathInfo},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"operationType",{get:function(){return this.m_operationType},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flags",{get:function(){return this.m_flags},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCollection",{get:function(){return this.m_isCollection},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isInvalidAfterRequest",{get:function(){return this.m_isInvalidAfterRequest},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parentObjectPath",{get:function(){return this.m_parentObjectPath},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"argumentObjectPaths",{get:function(){return this.m_argumentObjectPaths},set:function(n){this.m_argumentObjectPaths=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isValid",{get:function(){return this.m_isValid},set:function(n){this.m_isValid=n;!n&&this.m_objectPathInfo.ObjectPathType===6&&this.m_savedObjectPathInfo&&(i.copyObjectPathInfo(this.m_savedObjectPathInfo.pathInfo,this.m_objectPathInfo),this.m_parentObjectPath=this.m_savedObjectPathInfo.parent,this.m_isValid=!0,this.m_savedObjectPathInfo=null)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"originalObjectPathInfo",{get:function(){return this.m_originalObjectPathInfo},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"getByIdMethodName",{get:function(){return this.m_getByIdMethodName},set:function(n){this.m_getByIdMethodName=n},enumerable:!0,configurable:!0}),i.prototype._updateAsNullObject=function(){this.resetForUpdateUsingObjectData();this.m_objectPathInfo.ObjectPathType=7;this.m_objectPathInfo.Name="";this.m_parentObjectPath=null},i.prototype.saveOriginalObjectPathInfo=function(){n.config.extendedErrorLogging&&!this.m_originalObjectPathInfo&&(this.m_originalObjectPathInfo={},i.copyObjectPathInfo(this.m_objectPathInfo,this.m_originalObjectPathInfo))},i.prototype.updateUsingObjectData=function(n,r){var l=n[y.referenceId],h,c,f,e,o,a,s,u;if(!t.isNullOrEmptyString(l)){this.m_savedObjectPathInfo||this.isInvalidAfterRequest||!i.isRestorableObjectPath(this.m_objectPathInfo.ObjectPathType)||(h={},i.copyObjectPathInfo(this.m_objectPathInfo,h),this.m_savedObjectPathInfo={pathInfo:h,parent:this.m_parentObjectPath});this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();this.m_objectPathInfo.ObjectPathType=6;this.m_objectPathInfo.Name=l;delete this.m_objectPathInfo.ParentObjectPathId;this.m_parentObjectPath=null;return}if(r&&(c=r[y.collectionPropertyPath],!t.isNullOrEmptyString(c)&&r.context&&(u=p.tryGetObjectIdFromLoadOrRetrieveResult(n),!t.isNullOrUndefined(u)))){for(f=c.split("."),e=r.context[f[0]],o=1;o<f.length;o++)e=e[f[o]];this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();this.m_parentObjectPath=e._objectPath;this.m_objectPathInfo.ParentObjectPathId=this.m_parentObjectPath.objectPathInfo.Id;this.m_objectPathInfo.ObjectPathType=5;this.m_objectPathInfo.Name="";this.m_objectPathInfo.ArgumentInfo.Arguments=[u];return}if(a=this.parentObjectPath&&this.parentObjectPath.isCollection,s=this.getByIdMethodName,(a||!t.isNullOrEmptyString(s))&&(u=p.tryGetObjectIdFromLoadOrRetrieveResult(n),!t.isNullOrUndefined(u))){this.saveOriginalObjectPathInfo();this.resetForUpdateUsingObjectData();t.isNullOrEmptyString(s)?(this.m_objectPathInfo.ObjectPathType=5,this.m_objectPathInfo.Name=""):(this.m_objectPathInfo.ObjectPathType=3,this.m_objectPathInfo.Name=s,this.m_getByIdMethodName=null);this.m_objectPathInfo.ArgumentInfo.Arguments=[u];return}},i.prototype.resetForUpdateUsingObjectData=function(){this.m_isInvalidAfterRequest=!1;this.m_isValid=!0;this.m_operationType=1;this.m_flags=4;this.m_objectPathInfo.ArgumentInfo={};this.m_argumentObjectPaths=null},i.isRestorableObjectPath=function(n){return n===1||n===5||n===3||n===4},i.copyObjectPathInfo=function(n,t){t.Id=n.Id;t.ArgumentInfo=n.ArgumentInfo;t.Name=n.Name;t.ObjectPathType=n.ObjectPathType;t.ParentObjectPathId=n.ParentObjectPathId},i}();n.ObjectPath=l;et=function(){function n(){this.m_nextId=0}return n.prototype._nextId=function(){return++this.m_nextId},n.prototype._addServiceApiAction=function(n,t,i,r){this.m_serviceApiQueue||(this.m_serviceApiQueue=new bt(this));this.m_serviceApiQueue.add(n,t,i,r)},n}();n.ClientRequestContextBase=et;wt=function(){function n(n){this.m_objectPath=n}return n.prototype._handleResult=function(n){t.isNullOrUndefined(n)?this.m_objectPath._updateAsNullObject():this.m_objectPath.updateUsingObjectData(n,null)},n}();ot=function(){function i(n){this.m_contextBase=n;this.m_actions=[];this.m_actionResultHandler={};this.m_referencedObjectPaths={};this.m_instantiatedObjectPaths={};this.m_preSyncPromises=[]}return i.prototype.addAction=function(n){this.m_actions.push(n);n.actionInfo.ActionType==1&&(this.m_instantiatedObjectPaths[n.actionInfo.ObjectPathId]=n)},Object.defineProperty(i.prototype,"hasActions",{get:function(){return this.m_actions.length>0},enumerable:!0,configurable:!0}),i.prototype._getLastAction=function(){return this.m_actions[this.m_actions.length-1]},i.prototype.ensureInstantiateObjectPath=function(n){var i,t,r;if(n){if(this.m_instantiatedObjectPaths[n.objectPathInfo.Id])return;this.ensureInstantiateObjectPath(n.parentObjectPath);this.ensureInstantiateObjectPaths(n.argumentObjectPaths);this.m_instantiatedObjectPaths[n.objectPathInfo.Id]||(i={Id:this.m_contextBase._nextId(),ActionType:1,Name:"",ObjectPathId:n.objectPathInfo.Id},t=new v(i,1,4),t.referencedObjectPath=n,this.addReferencedObjectPath(n),this.addAction(t),r=new wt(n),this.addActionResultHandler(t,r))}},i.prototype.ensureInstantiateObjectPaths=function(n){if(n)for(var t=0;t<n.length;t++)this.ensureInstantiateObjectPath(n[t])},i.prototype.addReferencedObjectPath=function(n){if(!this.m_referencedObjectPaths[n.objectPathInfo.Id]){if(!n.isValid)throw new r.RuntimeError({code:f.invalidObjectPath,message:t._getResourceString(h.invalidObjectPath,p.getObjectPathExpression(n)),debugInfo:{errorLocation:p.getObjectPathExpression(n)}});while(n)this.m_referencedObjectPaths[n.objectPathInfo.Id]=n,n.objectPathInfo.ObjectPathType==3&&this.addReferencedObjectPaths(n.argumentObjectPaths),n=n.parentObjectPath}},i.prototype.addReferencedObjectPaths=function(n){if(n)for(var t=0;t<n.length;t++)this.addReferencedObjectPath(n[t])},i.prototype.addActionResultHandler=function(n,t){this.m_actionResultHandler[n.actionInfo.Id]=t},i.prototype.aggregrateRequestFlags=function(n,t,i){return t===0&&(n=n|1,(i&2)==0&&(n=n&-17),n=n&-5),i&1&&(n=n|2),(i&4)==0&&(n=n&-5),n},i.prototype.finallyNormalizeFlags=function(t){return(t&1)==0&&(t=t&-17),n._internalConfig.enableConcurrentFlag||(t=t&-5),n._internalConfig.enableUndoableFlag||(t=t&-17),p.isSetSupported("RichApiRuntimeFlag","1.1")||(t=t&-5,t=t&-17),typeof this.m_flagsForTesting=="number"&&(t=this.m_flagsForTesting),t},i.prototype.buildRequestMessageBodyAndRequestFlags=function(){var t,e,u,o,s,f,r,h;n._internalConfig.enableEarlyDispose&&i._calculateLastUsedObjectPathIds(this.m_actions);t=20;e={};for(u in this.m_referencedObjectPaths)t=this.aggregrateRequestFlags(t,this.m_referencedObjectPaths[u].operationType,this.m_referencedObjectPaths[u].flags),e[u]=this.m_referencedObjectPaths[u].objectPathInfo;for(o=[],s=!1,f=0;f<this.m_actions.length;f++)r=this.m_actions[f],r.actionInfo.ActionType===3&&r.actionInfo.Name===y.keepReference&&(s=!0),t=this.aggregrateRequestFlags(t,r.operationType,r.flags),o.push(r.actionInfo);return t=this.finallyNormalizeFlags(t),h={AutoKeepReference:this.m_contextBase._autoCleanup&&s,Actions:o,ObjectPaths:e},{body:h,flags:t}},i.prototype.processResponse=function(n){var t,i,r;if(n)for(t=0;t<n.length;t++)i=n[t],r=this.m_actionResultHandler[i.ActionId],r&&r._handleResult(i.Value)},i.prototype.invalidatePendingInvalidObjectPaths=function(){for(var n in this.m_referencedObjectPaths)this.m_referencedObjectPaths[n].isInvalidAfterRequest&&(this.m_referencedObjectPaths[n].isValid=!1)},i.prototype._addPreSyncPromise=function(n){this.m_preSyncPromises.push(n)},Object.defineProperty(i.prototype,"_preSyncPromises",{get:function(){return this.m_preSyncPromises},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_actions",{get:function(){return this.m_actions},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_objectPaths",{get:function(){return this.m_referencedObjectPaths},enumerable:!0,configurable:!0}),i.prototype._removeKeepReferenceAction=function(n){for(var i,t=this.m_actions.length-1;t>=0;t--)if(i=this.m_actions[t].actionInfo,i.ObjectPathId===n&&i.ActionType===3&&i.Name===y.keepReference){this.m_actions.splice(t,1);break}},i._updateLastUsedActionIdOfObjectPathId=function(n,t,r){for(var u,e,f;t;){if(n[t.objectPathInfo.Id])return;if(n[t.objectPathInfo.Id]=r,u=t.argumentObjectPaths,u)for(e=u.length,f=0;f<e;f++)i._updateLastUsedActionIdOfObjectPathId(n,u[f],r);t=t.parentObjectPath}},i._calculateLastUsedObjectPathIds=function(n){for(var o,v,s,h,l,u,f,t,c,e={},a=n.length,r=a-1;r>=0;--r)if(t=n[r],u=t.actionInfo.Id,t.referencedObjectPath&&i._updateLastUsedActionIdOfObjectPathId(e,t.referencedObjectPath,u),o=t.referencedArgumentObjectPaths,o)for(v=o.length,s=0;s<v;s++)i._updateLastUsedActionIdOfObjectPathId(e,o[s],u);h={};for(l in e)u=e[l],f=h[u],f||(f=[],h[u]=f),f.push(parseInt(l));for(r=0;r<a;r++)t=n[r],c=h[t.actionInfo.Id],c&&c.length>0?t.actionInfo.L=c:t.actionInfo.L&&delete t.actionInfo.L},i}();n.ClientRequestBase=ot;rt=function(){function n(n){this.m_type=n}return Object.defineProperty(n.prototype,"value",{get:function(){if(!this.m_isLoaded)throw new r.RuntimeError({code:f.valueNotLoaded,message:t._getResourceString(h.valueNotLoaded),debugInfo:{errorLocation:"clientResult.value"}});return this.m_value},enumerable:!0,configurable:!0}),n.prototype._handleResult=function(n){(this.m_isLoaded=!0,typeof n=="object"&&n&&n._IsNull)||(this.m_value=this.m_type===1?p.adjustToDateTime(n):n)},n}();n.ClientResult=rt;bt=function(){function n(n){this.m_context=n;this.m_actions=[]}return n.prototype.add=function(n,t,i,r){var u=this;this.m_actions.push({action:n,resultHandler:t,resolve:i,reject:r});this.m_actions.length===1&&setTimeout(function(){return u.processActions()},0)},n.prototype.processActions=function(){var f=this,t,n,r,i;if(this.m_actions.length!==0){for(t=this.m_actions,this.m_actions=[],n=new ot(this.m_context),r=0;r<t.length;r++)i=t[r],n.ensureInstantiateObjectPath(i.action.referencedObjectPath),n.ensureInstantiateObjectPaths(i.action.referencedArgumentObjectPaths),n.addAction(i.action),n.addReferencedObjectPath(i.action.referencedObjectPath),n.addReferencedObjectPaths(i.action.referencedArgumentObjectPaths);var u=n.buildRequestMessageBodyAndRequestFlags(),e=u.body,o=u.flags,s={Url:a.localDocumentApiPrefix,Headers:null,Body:e},h=new st;h.executeAsync(this.m_context._customData,o,s).then(function(i){f.processResponse(n,t,i)}).catch(function(n){for(var r,i=0;i<t.length;i++)r=t[i],r.reject(n)})}},n.prototype.processResponse=function(n,t,i){var u=this.getErrorFromResponse(i),r=null;i.Body.Results?r=i.Body.Results:i.Body.ProcessedResults&&i.Body.ProcessedResults.Results&&(r=i.Body.ProcessedResults.Results);r||(r=[]);this.processActionResults(n,t,r,u)},n.prototype.getErrorFromResponse=function(n){return t.isNullOrEmptyString(n.ErrorCode)?n.Body&&n.Body.Error?new r.RuntimeError({code:n.Body.Error.Code,message:n.Body.Error.Message}):null:new r.RuntimeError({code:n.ErrorCode,message:n.ErrorMessage})},n.prototype.processActionResults=function(n,t,i,r){var e,f,o;for(n.processResponse(i),e=0;e<t.length;e++){var u=t[e],h=u.action.actionInfo.Id,s=!1;for(f=0;f<i.length;f++)if(h==i[f].ActionId){o=i[f].Value;u.resultHandler&&(u.resultHandler._handleResult(o),o=u.resultHandler.value);u.resolve&&u.resolve(o);s=!0;break}!s&&u.reject&&(r?u.reject(r):u.reject("No response for the action."))}},n}();st=function(){function n(){}return n.prototype.executeAsync=function(i,r,u){var f=u.Url,e,o,s;if(f.charAt(f.length-1)!="/"&&(f=f+"/"),f=f+a.processQuery,f=f+"?"+a.flags+"="+r.toString(),e={method:"POST",url:f,headers:{},body:u.Body},e.headers[a.sourceLibHeader]=n.SourceLibHeaderValue,e.headers["CONTENT-TYPE"]="application/json",u.Headers)for(o in u.Headers)e.headers[o]=u.Headers[o];return s=t._isLocalDocumentUrl(e.url)?ut.sendLocalDocumentRequest:ut.sendRequest,s(e).then(function(n){var i,r;return n.statusCode===200?i={ErrorCode:null,ErrorMessage:null,Headers:n.headers,Body:t._parseResponseBody(n)}:(t.log("Error Response:"+n.body),r=t._parseErrorResponse(n),i={ErrorCode:r.errorCode,ErrorMessage:r.errorMessage,Headers:n.headers,Body:null}),i})},n.SourceLibHeaderValue="officejs-rest",n}();n.HttpRequestExecutor=st;y=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.collectionPropertyPath="_collectionPropertyPath",t.id="Id",t.idLowerCase="id",t.idPrivate="_Id",t.keepReference="_KeepReference",t.objectPathIdPrivate="_ObjectPathId",t.referenceId="_ReferenceId",t}(a);n.CommonConstants=y;p=function(n){function i(){return n!==null&&n.apply(this,arguments)||this}return __extends(i,n),i.adjustToDateTime=function(n){var r,u;if(t.isNullOrUndefined(n))return null;if(typeof n=="string")return new Date(n);if(Array.isArray(n)){for(r=n,u=0;u<r.length;u++)r[u]=i.adjustToDateTime(r[u]);return r}throw t._createInvalidArgError({argumentName:"date"});},i.tryGetObjectIdFromLoadOrRetrieveResult=function(n){var i=n[y.id];return t.isNullOrUndefined(i)&&(i=n[y.idLowerCase]),t.isNullOrUndefined(i)&&(i=n[y.idPrivate]),i},i.getObjectPathExpression=function(n){for(var t="";n;){switch(n.objectPathInfo.ObjectPathType){case 1:t=t;break;case 2:t="new()"+(t.length>0?".":"")+t;break;case 3:t=i.normalizeName(n.objectPathInfo.Name)+"()"+(t.length>0?".":"")+t;break;case 4:t=i.normalizeName(n.objectPathInfo.Name)+(t.length>0?".":"")+t;break;case 5:t="getItem()"+(t.length>0?".":"")+t;break;case 6:t="_reference()"+(t.length>0?".":"")+t;break}n=n.parentObjectPath}return t},i.setMethodArguments=function(n,r,u){if(t.isNullOrUndefined(u))return null;var f=[],e=[],o=i.collectObjectPathInfos(n,u,f,e);return r.Arguments=u,o&&(r.ReferencedObjectPathIds=e),f},i.validateContext=function(n,i){if(n&&i&&i._context!==n)throw new r.RuntimeError({code:f.invalidRequestContext,message:t._getResourceString(h.invalidRequestContext)});},i.isSetSupported=function(n,t){return typeof window!="undefined"&&window.Office&&window.Office.context&&window.Office.context.requirements?window.Office.context.requirements.isSetSupported(n,t):!0},i.throwIfApiNotSupported=function(n,u,e,o){if(i._doApiNotSupportedCheck&&!i.isSetSupported(u,e)){var s=t._getResourceString(h.apiNotFoundDetails,[n,u+" "+e,o]);throw new r.RuntimeError({code:f.apiNotFound,message:s,debugInfo:{errorLocation:n}});}},i.collectObjectPathInfos=function(n,r,u,f){for(var o,h,c,s=!1,e=0;e<r.length;e++)r[e]instanceof it?(o=r[e],i.validateContext(n,o),r[e]=o._objectPath.objectPathInfo.Id,f.push(o._objectPath.objectPathInfo.Id),u.push(o._objectPath),s=!0):Array.isArray(r[e])?(h=[],c=i.collectObjectPathInfos(n,r[e],u,h),c?(f.push(h),s=!0):f.push(0)):t.isPlainJsonObject(r[e])?(f.push(0),i.replaceClientObjectPropertiesWithObjectPathIds(r[e],u)):f.push(0);return s},i.replaceClientObjectPropertiesWithObjectPathIds=function(n,r){var e,u,f,o,s,h;for(e in n)if(u=n[e],u instanceof it)r.push(u._objectPath),n[e]=(s={},s[y.objectPathIdPrivate]=u._objectPath.objectPathInfo.Id,s);else if(Array.isArray(u))for(f=0;f<u.length;f++)u[f]instanceof it?(o=u[f],r.push(o._objectPath),u[f]=(h={},h[y.objectPathIdPrivate]=o._objectPath.objectPathInfo.Id,h)):t.isPlainJsonObject(u[f])&&i.replaceClientObjectPropertiesWithObjectPathIds(u[f],r);else t.isPlainJsonObject(u)&&i.replaceClientObjectPropertiesWithObjectPathIds(u,r)},i.normalizeName=function(n){return n.substr(0,1).toLowerCase()+n.substr(1)},i._doApiNotSupportedCheck=!1,i}(t);n.CommonUtility=p;kt=function(){function n(){}return n.invokeMethod=function(n,i,r,u,f,e){return t.createPromise(function(t,e){var h=new rt,s={Id:n._context._nextId(),ActionType:3,Name:i,ObjectPathId:n._objectPath.objectPathInfo.Id,ArgumentInfo:{}},c=p.setMethodArguments(n._context,s.ArgumentInfo,u),o=new v(s,r,f);o.referencedObjectPath=n._objectPath;o.referencedArgumentObjectPaths=c;n._context._addServiceApiAction(o,h,t,e)})},n.invokeRetrieve=function(n,i){var r={};return i&&(r.Select=i),t.createPromise(function(t,i){var f=new rt,e={Id:n._context._nextId(),ActionType:7,Name:"",ObjectPathId:n._objectPath.objectPathInfo.Id,QueryInfo:r},u=new v(e,1,4);u.referencedObjectPath=n._objectPath;n._context._addServiceApiAction(u,f,t,i)})},n.invokeUpdate=function(n,i){return t.createPromise(function(t,r){var f={Id:n._context._nextId(),ActionType:9,Name:"",ObjectPathId:n._objectPath.objectPathInfo.Id,ObjectState:i},u=new v(f,0,0);u.referencedObjectPath=n._objectPath;n._context._addServiceApiAction(u,null,t,r)})},n.createRootServiceObject=function(n,t){var i={Id:t._nextId(),ObjectPathType:1,Name:""},r=new l(i,null,!1,!1,1,4);return new n(t,r)},n.createTopLevelServiceObject=function(n,t,i,r,u){var f={Id:t._nextId(),ObjectPathType:2,Name:i},e=new l(f,null,r,!1,1,u|4);return new n(t,e)},n.createPropertyObject=function(n,t,i,r,u){var f={Id:t._context._nextId(),ObjectPathType:4,Name:i,ParentObjectPathId:t._objectPath.objectPathInfo.Id},e=new l(f,t._objectPath,r,!1,1,u|4);return new n(t._context,e)},n.createIndexerObject=function(n,t,i){var r={Id:t._context._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},u;return r.ArgumentInfo.Arguments=i,u=new l(r,t._objectPath,!1,!1,1,4),new n(t._context,u)},n.createMethodObject=function(n,t,i,r,u,f,e,o,s){var c={Id:t._context._nextId(),ObjectPathType:3,Name:i,ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},a=p.setMethodArguments(t._context,c.ArgumentInfo,u),h=new l(c,t._objectPath,f,e,r,s);return h.argumentObjectPaths=a,h.getByIdMethodName=o,new n(t._context,h)},n.createMethodObjectAndInvokeRetrieve=function(n,i,r,u,f,e,o,s,h){var c={};return h&&(c.Select=h),t.createPromise(function(t,h){var y={Id:n._context._nextId(),ObjectPathType:3,Name:i,ParentObjectPathId:n._objectPath.objectPathInfo.Id,ArgumentInfo:{}},b=p.setMethodArguments(n._context,y.ArgumentInfo,u),a=new l(y,n._objectPath,f,e,r,s);a.argumentObjectPaths=b;a.getByIdMethodName=o;var k=new rt,d={Id:n._context._nextId(),ActionType:7,Name:"",ObjectPathId:a.objectPathInfo.Id,QueryInfo:c},w=new v(d,1,4);w.referencedObjectPath=a;n._context._addServiceApiAction(w,k,t,h)})},n.localDocumentContext=new et,n}();n.OperationalApiHelper=kt;g=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.propertyNotLoaded="PropertyNotLoaded",t.runMustReturnPromise="RunMustReturnPromise",t.cannotRegisterEvent="CannotRegisterEvent",t.invalidOrTimedOutSession="InvalidOrTimedOutSession",t.cannotUpdateReadOnlyProperty="CannotUpdateReadOnlyProperty",t}(f);n.ErrorCodes=g;dt=function(){function n(n){this.m_callback=n}return n.prototype._handleResult=function(n){this.m_callback&&this.m_callback()},n}();e=function(){function n(){}return n.createSetPropertyAction=function(n,t,r,u,f){var e;i.validateObjectPath(t);var s={Id:n._nextId(),ActionType:4,Name:r,ObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},h=[u],o=i.setMethodArguments(n,s.ArgumentInfo,h);return i.validateReferencedObjectPaths(o),n._pendingRequest.ensureInstantiateObjectPath(t._objectPath),n._pendingRequest.ensureInstantiateObjectPaths(o),e=new v(s,0,f),n._pendingRequest.addAction(e),n._pendingRequest.addReferencedObjectPath(t._objectPath),n._pendingRequest.addReferencedObjectPaths(o),e.referencedObjectPath=t._objectPath,e.referencedArgumentObjectPaths=o,e},n.createMethodAction=function(n,t,r,u,f,e){var h,o,s;return i.validateObjectPath(t),h={Id:n._nextId(),ActionType:3,Name:r,ObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},o=i.setMethodArguments(n,h.ArgumentInfo,f),i.validateReferencedObjectPaths(o),n._pendingRequest.ensureInstantiateObjectPath(t._objectPath),n._pendingRequest.ensureInstantiateObjectPaths(o),s=new v(h,u,i._fixupApiFlags(e)),n._pendingRequest.addAction(s),n._pendingRequest.addReferencedObjectPath(t._objectPath),n._pendingRequest.addReferencedObjectPaths(o),s.referencedObjectPath=t._objectPath,s.referencedArgumentObjectPaths=o,s},n.createQueryAction=function(n,t,r){var f,u;return i.validateObjectPath(t),n._pendingRequest.ensureInstantiateObjectPath(t._objectPath),f={Id:n._nextId(),ActionType:2,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id},f.QueryInfo=r,u=new v(f,1,4),n._pendingRequest.addAction(u),n._pendingRequest.addReferencedObjectPath(t._objectPath),u.referencedObjectPath=t._objectPath,u},n.createRecursiveQueryAction=function(n,t,r){i.validateObjectPath(t);n._pendingRequest.ensureInstantiateObjectPath(t._objectPath);var f={Id:n._nextId(),ActionType:6,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,RecursiveQueryInfo:r},u=new v(f,1,4);return n._pendingRequest.addAction(u),n._pendingRequest.addReferencedObjectPath(t._objectPath),u.referencedObjectPath=t._objectPath,u},n.createQueryAsJsonAction=function(n,t,r){var f,u;return i.validateObjectPath(t),n._pendingRequest.ensureInstantiateObjectPath(t._objectPath),f={Id:n._nextId(),ActionType:7,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id},f.QueryInfo=r,u=new v(f,1,4),n._pendingRequest.addAction(u),n._pendingRequest.addReferencedObjectPath(t._objectPath),u.referencedObjectPath=t._objectPath,u},n.createEnsureUnchangedAction=function(n,t,r){i.validateObjectPath(t);n._pendingRequest.ensureInstantiateObjectPath(t._objectPath);var f={Id:n._nextId(),ActionType:8,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,ObjectState:r},u=new v(f,1,4);return n._pendingRequest.addAction(u),n._pendingRequest.addReferencedObjectPath(t._objectPath),u.referencedObjectPath=t._objectPath,u},n.createUpdateAction=function(n,t,r){i.validateObjectPath(t);n._pendingRequest.ensureInstantiateObjectPath(t._objectPath);var f={Id:n._nextId(),ActionType:9,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id,ObjectState:r},u=new v(f,0,0);return n._pendingRequest.addAction(u),n._pendingRequest.addReferencedObjectPath(t._objectPath),u.referencedObjectPath=t._objectPath,u},n.createInstantiateAction=function(n,t){i.validateObjectPath(t);n._pendingRequest.ensureInstantiateObjectPath(t._objectPath.parentObjectPath);n._pendingRequest.ensureInstantiateObjectPaths(t._objectPath.argumentObjectPaths);var u={Id:n._nextId(),ActionType:1,Name:"",ObjectPathId:t._objectPath.objectPathInfo.Id},r=new v(u,1,4);return r.referencedObjectPath=t._objectPath,n._pendingRequest.addAction(r),n._pendingRequest.addReferencedObjectPath(t._objectPath),n._pendingRequest.addActionResultHandler(r,new ri(t)),r},n.createTraceAction=function(n,t,i){var r={Id:n._nextId(),ActionType:5,Name:"Trace",ObjectPathId:0},u=new v(r,1,4);return n._pendingRequest.addAction(u),i&&n._pendingRequest.addTrace(r.Id,t),u},n.createTraceMarkerForCallback=function(t,i){var r=n.createTraceAction(t,null,!1);t._pendingRequest.addActionResultHandler(r,new dt(i))},n}();n.ActionFactory=e;ht=function(s){function c(n,t){var r=s.call(this,n,t)||this;return i.checkArgumentNull(n,"context"),r.m_context=n,r._objectPath&&!n._processingResult&&n._pendingRequest&&(e.createInstantiateAction(n,r),n._autoCleanup&&r._KeepReference&&n.trackedObjects._autoAdd(r)),r}return __extends(c,s),Object.defineProperty(c.prototype,"context",{get:function(){return this.m_context},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isNull",{get:function(){return i.throwIfNotLoaded("isNull",this._isNull,null,this._isNull),this._isNull},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isNullObject",{get:function(){return i.throwIfNotLoaded("isNullObject",this._isNull,null,this._isNull),this._isNull},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_isNull",{get:function(){return this.m_isNull},set:function(n){this.m_isNull=n;n&&this._objectPath&&this._objectPath._updateAsNullObject()},enumerable:!0,configurable:!0}),c.prototype._handleResult=function(n){this._isNull=i.isNullOrUndefined(n);this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,n)},c.prototype._handleIdResult=function(n){this._isNull=i.isNullOrUndefined(n);i.fixObjectPathIfNecessary(this,n);this.context.trackedObjects._autoTrackIfNecessaryWhenHandleObjectResultValue(this,n)},c.prototype._handleRetrieveResult=function(n,t){this._handleIdResult(n)},c.prototype._recursivelySet=function(n,u,e,s,l){var p=n instanceof c,k=n,a,b,y,v,w;if(p)if(Object.getPrototypeOf(this)===Object.getPrototypeOf(n))n=JSON.parse(JSON.stringify(n));else throw r.RuntimeError._createInvalidArgError({argumentName:"properties",errorLocation:this._className+".set"});try{for(v=0;v<e.length;v++)a=e[v],n.hasOwnProperty(a)&&typeof n[a]!="undefined"&&(this[a]=n[a]);for(v=0;v<s.length;v++)a=s[v],n.hasOwnProperty(a)&&typeof n[a]!="undefined"&&(b=p?k[a]:n[a],this[a].set(b,u));for(y=!p,u&&!i.isNullOrUndefined(y)&&(y=u.throwOnReadOnly),v=0;v<l.length;v++)if(a=l[v],n.hasOwnProperty(a)&&typeof n[a]!="undefined"&&y)throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(o.cannotApplyPropertyThroughSetMethod,a),debugInfo:{errorLocation:a}});for(a in n)if(e.indexOf(a)<0&&s.indexOf(a)<0){if(w=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),a),!w)throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(o.propertyDoesNotExist,a),debugInfo:{errorLocation:a}});if(y&&!w.set)throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(o.attemptingToSetReadOnlyProperty,a),debugInfo:{errorLocation:a}});}}catch(d){throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(h.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".set"},innerError:d});}},c.prototype._recursivelyUpdate=function(s){var p=n._internalConfig.alwaysPolyfillClientObjectUpdateMethod,l,v,y,k,a,d,c,nt,tt;p||(p=!i.isSetSupported("RichApiRuntime","1.2"));try{if(l=this[u.scalarPropertyNames],l||(l=[]),v=this[u.scalarPropertyUpdateable],!v)for(v=[],a=0;a<l.length;a++)v.push(!1);y=this[u.navigationPropertyNames];y||(y=[]);var w={},b={},g=0;for(c in s)if(k=l.indexOf(c),k>=0){if(!v[k])throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(o.attemptingToSetReadOnlyProperty,c),debugInfo:{errorLocation:c}});w[c]=s[c];++g}else if(y.indexOf(c)>=0)b[c]=s[c];else throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(o.propertyDoesNotExist,c),debugInfo:{errorLocation:c}});if(g>0)if(p)for(a=0;a<l.length;a++)c=l[a],d=w[c],i.isUndefined(d)||e.createSetPropertyAction(this.context,this,c,d);else e.createUpdateAction(this.context,this,w);for(c in b)nt=this[c],tt=b[c],nt._recursivelyUpdate(tt)}catch(it){throw new r.RuntimeError({code:f.invalidArgument,message:t._getResourceString(h.invalidArgument,"properties"),debugInfo:{errorLocation:this._className+".update"},innerError:it});}},c}(it);n.ClientObject=ht;var si=function(){function n(n){this.m_session=n}return n.prototype.executeAsync=function(n,i,r){var f={url:a.processQuery,method:"POST",headers:r.Headers,body:r.Body},u={id:d.nextId(),type:1,flags:i,message:f};return t.log(JSON.stringify(u)),this.m_session.sendMessageToHost(u).then(function(n){var i,r,u;return t.log("Received response: "+JSON.stringify(n)),i=n.message,i.statusCode===200?r={ErrorCode:null,ErrorMessage:null,Headers:i.headers,Body:t._parseResponseBody(i)}:(t.log("Error Response:"+i.body),u=t._parseErrorResponse(i),r={ErrorCode:u.errorCode,ErrorMessage:u.errorMessage,Headers:i.headers,Body:null}),r})},n}(),gt=function(n){function i(t){var i=n.call(this)||this;return i.m_bridge=t,i.m_bridge.addHostMessageHandler(function(n){n.type===3&&w.getGenericEventRegistration()._handleRichApiMessage(n.message)}),i}return __extends(i,n),i.getInstanceIfHostBridgeInited=function(){return d.instance?((t.isNullOrUndefined(i.s_instance)||i.s_instance.m_bridge!==d.instance)&&(i.s_instance=new i(d.instance)),i.s_instance):null},i.prototype._resolveRequestUrlAndHeaderInfo=function(){return t._createPromiseFromResult(null)},i.prototype._createRequestExecutorOrNull=function(){return t.log("NativeBridgeSession::CreateRequestExecutor"),new si(this)},Object.defineProperty(i.prototype,"eventRegistration",{get:function(){return w.getGenericEventRegistration()},enumerable:!0,configurable:!0}),i.prototype.sendMessageToHost=function(n){return this.m_bridge.sendMessageToHostAndExpectResponse(n)},i}(k),ni=function(s){function c(n){var f=s.call(this)||this,e;if(f.m_customRequestHeaders={},f.m_batchMode=0,f._onRunFinishedNotifiers=[],k._overrideSession)f.m_requestUrlAndHeaderInfoResolver=k._overrideSession;else if((i.isNullOrUndefined(n)||typeof n=="string"&&n.length===0)&&(n=c.defaultRequestUrlAndHeaders,n||(n={url:a.localDocument,headers:{}})),typeof n=="string")f.m_requestUrlAndHeaderInfo={url:n,headers:{}};else if(c.isRequestUrlAndHeaderInfoResolver(n))f.m_requestUrlAndHeaderInfoResolver=n;else if(c.isRequestUrlAndHeaderInfo(n))e=n,f.m_requestUrlAndHeaderInfo={url:e.url,headers:{}},t._copyHeaders(e.headers,f.m_requestUrlAndHeaderInfo.headers);else throw r.RuntimeError._createInvalidArgError({argumentName:"url"});return!f.m_requestUrlAndHeaderInfoResolver&&f.m_requestUrlAndHeaderInfo&&t._isLocalDocumentUrl(f.m_requestUrlAndHeaderInfo.url)&&gt.getInstanceIfHostBridgeInited()&&(f.m_requestUrlAndHeaderInfo=null,f.m_requestUrlAndHeaderInfoResolver=gt.getInstanceIfHostBridgeInited()),f.m_requestUrlAndHeaderInfoResolver instanceof k&&(f.m_session=f.m_requestUrlAndHeaderInfoResolver),f._processingResult=!1,f._customData=u.iterativeExecutor,f.sync=f.sync.bind(f),f}return __extends(c,s),Object.defineProperty(c.prototype,"session",{get:function(){return this.m_session},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"eventRegistration",{get:function(){return this.m_session?this.m_session.eventRegistration:r.officeJsEventRegistration},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_url",{get:function(){return this.m_requestUrlAndHeaderInfo?this.m_requestUrlAndHeaderInfo.url:null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_pendingRequest",{get:function(){return this.m_pendingRequest==null&&(this.m_pendingRequest=new tt(this)),this.m_pendingRequest},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"debugInfo",{get:function(){var t=new at(this._rootObjectPropertyName,this._pendingRequest._objectPaths,this._pendingRequest._actions,n._internalConfig.showDisposeInfoInDebugInfo),i=t.process();return{pendingStatements:i}},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"trackedObjects",{get:function(){return this.m_trackedObjects||(this.m_trackedObjects=new yt(this)),this.m_trackedObjects},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"requestHeaders",{get:function(){return this.m_customRequestHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"batchMode",{get:function(){return this.m_batchMode},enumerable:!0,configurable:!0}),c.prototype.ensureInProgressBatchIfBatchMode=function(){if(this.m_batchMode===1&&!this.m_explicitBatchInProgress)throw i.createRuntimeError(f.generalException,t._getResourceString(o.notInsideBatch),null);},c.prototype.load=function(n,t){i.validateContext(this,n);var r=c._parseQueryOption(t),u=e.createQueryAction(this,n,r);this._pendingRequest.addActionResultHandler(u,n)},c.isLoadOption=function(n){if(!i.isUndefined(n.select)&&(typeof n.select=="string"||Array.isArray(n.select))||!i.isUndefined(n.expand)&&(typeof n.expand=="string"||Array.isArray(n.expand))||!i.isUndefined(n.top)&&typeof n.top=="number"||!i.isUndefined(n.skip)&&typeof n.skip=="number")return!0;for(var t in n)return!1;return!0},c.parseStrictLoadOption=function(n){var t={Select:[]};return c.parseStrictLoadOptionHelper(t,"","option",n),t},c.combineQueryPath=function(n,t,i){return n.length===0?t:n+i+t},c.parseStrictLoadOptionHelper=function(n,t,i,u){var f,e;for(f in u)if(e=u[f],f==="$all"){if(typeof e!="boolean")throw r.RuntimeError._createInvalidArgError({argumentName:c.combineQueryPath(i,f,".")});e&&n.Select.push(c.combineQueryPath(t,"*","/"))}else if(f==="$top"){if(typeof e!="number"||t.length>0)throw r.RuntimeError._createInvalidArgError({argumentName:c.combineQueryPath(i,f,".")});n.Top=e}else if(f==="$skip"){if(typeof e!="number"||t.length>0)throw r.RuntimeError._createInvalidArgError({argumentName:c.combineQueryPath(i,f,".")});n.Skip=e}else if(typeof e=="boolean")e&&n.Select.push(c.combineQueryPath(t,f,"/"));else if(typeof e=="object")c.parseStrictLoadOptionHelper(n,c.combineQueryPath(t,f,"/"),c.combineQueryPath(i,f,"."),e);else throw r.RuntimeError._createInvalidArgError({argumentName:c.combineQueryPath(i,f,".")});},c._parseQueryOption=function(n){var u={},f,t;if(typeof n=="string")f=n,u.Select=i._parseSelectExpand(f);else if(Array.isArray(n))u.Select=n;else if(typeof n=="object")if(t=n,c.isLoadOption(t)){if(typeof t.select=="string")u.Select=i._parseSelectExpand(t.select);else if(Array.isArray(t.select))u.Select=t.select;else if(!i.isNullOrUndefined(t.select))throw r.RuntimeError._createInvalidArgError({argumentName:"option.select"});if(typeof t.expand=="string")u.Expand=i._parseSelectExpand(t.expand);else if(Array.isArray(t.expand))u.Expand=t.expand;else if(!i.isNullOrUndefined(t.expand))throw r.RuntimeError._createInvalidArgError({argumentName:"option.expand"});if(typeof t.top=="number")u.Top=t.top;else if(!i.isNullOrUndefined(t.top))throw r.RuntimeError._createInvalidArgError({argumentName:"option.top"});if(typeof t.skip=="number")u.Skip=t.skip;else if(!i.isNullOrUndefined(t.skip))throw r.RuntimeError._createInvalidArgError({argumentName:"option.skip"});}else u=c.parseStrictLoadOption(n);else if(!i.isNullOrUndefined(n))throw r.RuntimeError._createInvalidArgError({argumentName:"option"});return u},c.prototype.loadRecursive=function(n,t,u){var f,o,s;if(!i.isPlainJsonObject(t))throw r.RuntimeError._createInvalidArgError({argumentName:"options"});f={};for(o in t)f[o]=c._parseQueryOption(t[o]);s=e.createRecursiveQueryAction(this,n,{Queries:f,MaxDepth:u});this._pendingRequest.addActionResultHandler(s,n)},c.prototype.trace=function(n){e.createTraceAction(this,n,!0)},c.prototype._processOfficeJsErrorResponse=function(n,t){},c.prototype.ensureRequestUrlAndHeaderInfo=function(){var n=this;return i._createPromiseFromResult(null).then(function(){if(!n.m_requestUrlAndHeaderInfo)return n.m_requestUrlAndHeaderInfoResolver._resolveRequestUrlAndHeaderInfo().then(function(t){if(n.m_requestUrlAndHeaderInfo=t,n.m_requestUrlAndHeaderInfo||(n.m_requestUrlAndHeaderInfo={url:a.localDocument,headers:{}}),i.isNullOrEmptyString(n.m_requestUrlAndHeaderInfo.url)&&(n.m_requestUrlAndHeaderInfo.url=a.localDocument),n.m_requestUrlAndHeaderInfo.headers||(n.m_requestUrlAndHeaderInfo.headers={}),typeof n.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull=="function"){var r=n.m_requestUrlAndHeaderInfoResolver._createRequestExecutorOrNull();r&&(n._requestExecutor=r)}})})},c.prototype.syncPrivateMain=function(){var n=this;return this.ensureRequestUrlAndHeaderInfo().then(function(){var t=n._pendingRequest;return n.m_pendingRequest=null,n.processPreSyncPromises(t).then(function(){return n.syncPrivate(t)})})},c.prototype.syncPrivate=function(n){var s=this,l,e,a,f,u;if(!n.hasActions)return this.processPendingEventHandlers(n);var c=n.buildRequestMessageBodyAndRequestFlags(),v=c.body,h=c.flags;return this._requestFlagModifier&&(h|=this._requestFlagModifier),this._requestExecutor||(this._requestExecutor=t._isLocalDocumentUrl(this.m_requestUrlAndHeaderInfo.url)?new ui(this):new st),l=this._requestExecutor,e={},t._copyHeaders(this.m_requestUrlAndHeaderInfo.headers,e),t._copyHeaders(this.m_customRequestHeaders,e),a={Url:this.m_requestUrlAndHeaderInfo.url,Headers:e,Body:v},n.invalidatePendingInvalidObjectPaths(),f=null,u=null,this._lastSyncStart=typeof performance=="undefined"?0:performance.now(),this._lastRequestFlags=h,l.executeAsync(this._customData,h,a).then(function(i){return s._lastSyncEnd=typeof performance=="undefined"?0:performance.now(),f=s.processRequestExecutorResponseMessage(n,i),s.processPendingEventHandlers(n).catch(function(n){t.log("Error in processPendingEventHandlers");t.log(JSON.stringify(n));u=n})}).then(function(){var e,s;if(f){t.log("Throw error from response: "+JSON.stringify(f));throw f;}if(u){t.log("Throw error from ProcessEventHandler: "+JSON.stringify(u));e=null;u instanceof r.RuntimeError?(e=u,e.traceMessages=n._responseTraceMessages):(s=null,s=typeof u=="string"?u:u.message,i.isNullOrEmptyString(s)&&(s=t._getResourceString(o.cannotRegisterEvent)),e=new r.RuntimeError({code:g.cannotRegisterEvent,message:s,traceMessages:n._responseTraceMessages}));throw e;}})},c.prototype.processRequestExecutorResponseMessage=function(t,u){var h,f,s,c,e,o;if(u.Body&&u.Body.TraceIds&&t._setResponseTraceIds(u.Body.TraceIds),h=t._responseTraceMessages,f=null,u.Body&&(u.Body.Error&&u.Body.Error.ActionIndex>=0&&(s=new at(this._rootObjectPropertyName,t._objectPaths,t._actions,!1,!0),c=s.processForDebugStatementInfo(u.Body.Error.ActionIndex),f={statement:c.statement,surroundingStatements:c.surroundingStatements,fullStatements:["Please enable config.extendedErrorLogging to see full statements."]},n.config.extendedErrorLogging&&(s=new at(this._rootObjectPropertyName,t._objectPaths,t._actions,!1,!1),f.fullStatements=s.process())),e=null,u.Body.Results?e=u.Body.Results:u.Body.ProcessedResults&&u.Body.ProcessedResults.Results&&(e=u.Body.ProcessedResults.Results),e)){this._processingResult=!0;try{t.processResponse(e)}finally{this._processingResult=!1}}if(i.isNullOrEmptyString(u.ErrorCode)){if(u.Body&&u.Body.Error)return o={errorLocation:u.Body.Error.Location},f&&(o.statement=f.statement,o.surroundingStatements=f.surroundingStatements,o.fullStatements=f.fullStatements),new r.RuntimeError({code:u.Body.Error.Code,message:u.Body.Error.Message,traceMessages:h,debugInfo:o})}else return new r.RuntimeError({code:u.ErrorCode,message:u.ErrorMessage,traceMessages:h});return null},c.prototype.processPendingEventHandlers=function(n){for(var u,t=i._createPromiseFromResult(null),r=0;r<n._pendingProcessEventHandlers.length;r++)u=n._pendingProcessEventHandlers[r],t=t.then(this.createProcessOneEventHandlersFunc(u,n));return t},c.prototype.createProcessOneEventHandlersFunc=function(n,t){return function(){return n._processRegistration(t)}},c.prototype.processPreSyncPromises=function(n){for(var u,t=i._createPromiseFromResult(null),r=0;r<n._preSyncPromises.length;r++)u=n._preSyncPromises[r],t=t.then(this.createProcessOneProSyncFunc(u));return t},c.prototype.createProcessOneProSyncFunc=function(n){return function(){return n}},c.prototype.sync=function(n){return this.syncPrivateMain().then(function(){return n})},c.prototype.batch=function(n){var r=this,e,u,s,h;if(this.m_batchMode!==1)return t._createPromiseFromException(i.createRuntimeError(f.generalException,null,null));if(this.m_explicitBatchInProgress)return t._createPromiseFromException(i.createRuntimeError(f.generalException,t._getResourceString(o.pendingBatchInProgress),null));if(i.isNullOrUndefined(n))return i._createPromiseFromResult(null);this.m_explicitBatchInProgress=!0;e=this.m_pendingRequest;this.m_pendingRequest=new tt(this);try{u=n(this._rootObject,this)}catch(c){return this.m_explicitBatchInProgress=!1,this.m_pendingRequest=e,t._createPromiseFromException(c)}return typeof u=="object"&&u&&typeof u.then=="function"?h=i._createPromiseFromResult(null).then(function(){return u}).then(function(n){return r.m_explicitBatchInProgress=!1,s=r.m_pendingRequest,r.m_pendingRequest=e,n}).catch(function(n){return r.m_explicitBatchInProgress=!1,s=r.m_pendingRequest,r.m_pendingRequest=e,t._createPromiseFromException(n)}):(this.m_explicitBatchInProgress=!1,s=this.m_pendingRequest,this.m_pendingRequest=e,h=i._createPromiseFromResult(u)),h.then(function(n){return r.ensureRequestUrlAndHeaderInfo().then(function(){return r.syncPrivate(s)}).then(function(){return n})})},c._run=function(n,t,i,r,u,f){return i===void 0&&(i=3),r===void 0&&(r=5e3),c._runCommon("run",null,n,0,t,i,r,null,u,f)},c.isValidRequestInfo=function(n){return typeof n=="string"||c.isRequestUrlAndHeaderInfo(n)||c.isRequestUrlAndHeaderInfoResolver(n)},c.isRequestUrlAndHeaderInfo=function(n){return typeof n=="object"&&n!==null&&Object.getPrototypeOf(n)===Object.getPrototypeOf({})&&!i.isNullOrUndefined(n.url)},c.isRequestUrlAndHeaderInfoResolver=function(n){return typeof n=="object"&&n!==null&&typeof n._resolveRequestUrlAndHeaderInfo=="function"},c._runBatch=function(n,t,i,r,u,f,e,o){return u===void 0&&(u=3),f===void 0&&(f=5e3),c._runBatchCommon(0,n,t,i,u,f,r,e,o)},c._runExplicitBatch=function(n,t,i,r,u,f,e,o){return u===void 0&&(u=3),f===void 0&&(f=5e3),c._runBatchCommon(1,n,t,i,u,f,r,e,o)},c._runBatchCommon=function(n,t,r,u,f,e,s,h,l){var y,k,g;f===void 0&&(f=3);e===void 0&&(e=5e3);var p,d,w=null,a=null,v=0,b=null;if(r.length>0)if(c.isValidRequestInfo(r[0]))w=r[0],v=1;else if(i.isPlainJsonObject(r[0])){if(b=r[0],w=b.session,w!=null&&!c.isValidRequestInfo(w))return c.createErrorPromise(t);a=b.previousObjects;v=1}if(r.length==v+1)d=r[v+0];else if(b==null&&r.length==v+2)a=r[v+0],d=r[v+1];else return c.createErrorPromise(t);if(a!=null)if(a instanceof ht)p=function(){return a.context};else if(a instanceof c)p=function(){return a};else if(Array.isArray(a)){if(y=a,y.length==0)return c.createErrorPromise(t);for(k=0;k<y.length;k++){if(!(y[k]instanceof ht))return c.createErrorPromise(t);if(y[k].context!=y[0].context)return c.createErrorPromise(t,o.invalidRequestContext)}p=function(){return y[0].context}}else return c.createErrorPromise(t);else p=u;return g=null,s&&(g=function(n){return s(b||{},n)}),c._runCommon(t,w,p,n,d,f,e,g,h,l)},c.createErrorPromise=function(n,r){return r===void 0&&(r=h.invalidArgument),t._createPromiseFromException(i.createRuntimeError(r,t._getResourceString(r),n))},c._runCommon=function(r,u,f,e,s,h,l,a,v,y){k._overrideSession&&(u=k._overrideSession);var g=t.createPromise(function(n,t){n()}),p,b=!1,w,d;return g.then(function(){if(p=f(u),p._autoCleanup)return new n.Promise(function(n,t){p._onRunFinishedNotifiers.push(function(){p._autoCleanup=!0;n()})});else p._autoCleanup=!0}).then(function(){if(typeof s!="function")return c.createErrorPromise(r);d=p.m_batchMode;p.m_batchMode=e;a&&a(p);var n;return n=e==1?s(p.batch.bind(p)):s(p),(i.isNullOrUndefined(n)||typeof n.then!="function")&&i.throwError(o.runMustReturnPromise),n}).then(function(n){return e===1?n:p.sync(n)}).then(function(n){b=!0;w=n}).catch(function(n){w=n}).then(function(){function r(){var u;n++;var f=p.m_pendingRequest,e=p.m_batchMode,i=new tt(p);p.m_pendingRequest=i;p.m_batchMode=0;try{for(u in t)p.trackedObjects.remove(t[u])}finally{p.m_batchMode=e;p.m_pendingRequest=f}return p.syncPrivate(i).then(function(){v&&v(n)}).catch(function(){y&&y(n);n<h&&setTimeout(function(){r()},l)})}var t=p.trackedObjects._retrieveAndClearAutoCleanupList(),f,n;p._autoCleanup=!1;p.m_batchMode=d;for(f in t)t[f]._objectPath.isValid=!1;if(n=0,i._synchronousCleanup||c.isRequestUrlAndHeaderInfoResolver(u))return r();else r()}).then(function(){if(p._onRunFinishedNotifiers&&p._onRunFinishedNotifiers.length>0){var n=p._onRunFinishedNotifiers.shift();n()}if(b)return w;else throw w;})},c}(et);n.ClientRequestContext=ni;ti=function(){function n(n,t){var r;this.m_proxy=n;this.m_shouldPolyfill=t;var f=n[u.scalarPropertyNames],e=n[u.navigationPropertyNames],o=n[u.className],s=n[u.isCollection];if(f)for(r=0;r<f.length;r++)i.definePropertyThrowUnloadedException(this,o,f[r]);if(e)for(r=0;r<e.length;r++)i.definePropertyThrowUnloadedException(this,o,e[r]);s&&i.definePropertyThrowUnloadedException(this,o,u.itemsLowerCase)}return Object.defineProperty(n.prototype,"$proxy",{get:function(){return this.m_proxy},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"$isNullObject",{get:function(){if(!this.m_isLoaded)throw new r.RuntimeError({code:g.valueNotLoaded,message:t._getResourceString(o.valueNotLoaded),debugInfo:{errorLocation:"retrieveResult.$isNullObject"}});return this.m_isNullObject},enumerable:!0,configurable:!0}),n.prototype.toJSON=function(){return this.m_isLoaded?this.m_isNullObject?null:(i.isUndefined(this.m_json)&&(this.m_json=this.purifyJson(this.m_value)),this.m_json):undefined},n.prototype.toString=function(){return JSON.stringify(this.toJSON())},n.prototype._handleResult=function(n){this.m_isLoaded=!0;n===null||typeof n=="object"&&n&&n._IsNull?(this.m_isNullObject=!0,n=null):this.m_isNullObject=!1;this.m_shouldPolyfill&&(n=this.changePropertyNameToCamelLowerCase(n));this.m_value=n;this.m_proxy._handleRetrieveResult(n,this)},n.prototype.changePropertyNameToCamelLowerCase=function(n){var s=95,r,t,f,e,o;if(Array.isArray(n)){for(t=[],r=0;r<n.length;r++)t.push(this.changePropertyNameToCamelLowerCase(n[r]));return t}else if(typeof n=="object"&&n!==null){t={};for(f in n)if(e=n[f],f===u.items){t={};t[u.itemsLowerCase]=this.changePropertyNameToCamelLowerCase(e);break}else o=i._toCamelLowerCase(f),t[o]=this.changePropertyNameToCamelLowerCase(e);return t}else return n},n.prototype.purifyJson=function(n){var f=95,r,i,u,t;if(Array.isArray(n)){for(i=[],r=0;r<n.length;r++)i.push(this.purifyJson(n[r]));return i}else if(typeof n=="object"&&n!==null){i={};for(u in n)u.charCodeAt(0)!==f&&(t=n[u],typeof t=="object"&&t!==null&&Array.isArray(t.items)&&(t=t.items),i[u]=this.purifyJson(t));return i}else return n},n}();u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.getItemAt="GetItemAt",t.index="_Index",t.items="_Items",t.iterativeExecutor="IterativeExecutor",t.isTracked="_IsTracked",t.eventMessageCategory=65536,t.eventWorkbookId="Workbook",t.eventSourceRemote="Remote",t.itemsLowerCase="items",t.proxy="$proxy",t.scalarPropertyNames="_scalarPropertyNames",t.navigationPropertyNames="_navigationPropertyNames",t.className="_className",t.isCollection="_isCollection",t.scalarPropertyUpdateable="_scalarPropertyUpdateable",t.collectionPropertyPath="_collectionPropertyPath",t.objectPathInfoDoNotKeepReferenceFieldName="D",t}(y);n.Constants=u;tt=function(n){function i(t){var i=n.call(this,t)||this;return i.m_context=t,i.m_pendingProcessEventHandlers=[],i.m_pendingEventHandlerActions={},i.m_traceInfos={},i.m_responseTraceIds={},i.m_responseTraceMessages=[],i}return __extends(i,n),Object.defineProperty(i.prototype,"traceInfos",{get:function(){return this.m_traceInfos},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_responseTraceMessages",{get:function(){return this.m_responseTraceMessages},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_responseTraceIds",{get:function(){return this.m_responseTraceIds},enumerable:!0,configurable:!0}),i.prototype._setResponseTraceIds=function(n){var i,r,u;if(n)for(i=0;i<n.length;i++)r=n[i],this.m_responseTraceIds[r]=r,u=this.m_traceInfos[r],t.isNullOrUndefined(u)||this.m_responseTraceMessages.push(u)},i.prototype.addTrace=function(n,t){this.m_traceInfos[n]=t},i.prototype._addPendingEventHandlerAction=function(n,t){this.m_pendingEventHandlerActions[n._id]||(this.m_pendingEventHandlerActions[n._id]=[],this.m_pendingProcessEventHandlers.push(n));this.m_pendingEventHandlerActions[n._id].push(t)},Object.defineProperty(i.prototype,"_pendingProcessEventHandlers",{get:function(){return this.m_pendingProcessEventHandlers},enumerable:!0,configurable:!0}),i.prototype._getPendingEventHandlerActions=function(n){return this.m_pendingEventHandlerActions[n._id]},i}(ot);n.ClientRequest=tt;vt=function(){function n(n,t,i,r){var u=this;this.m_id=n._nextId();this.m_context=n;this.m_name=i;this.m_handlers=[];this.m_registered=!1;this.m_eventInfo=r;this.m_callback=function(n){u.m_eventInfo.eventArgsTransformFunc(n).then(function(n){return u.fireEvent(n)})}}return Object.defineProperty(n.prototype,"_registered",{get:function(){return this.m_registered},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_id",{get:function(){return this.m_id},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_handlers",{get:function(){return this.m_handlers},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_context",{get:function(){return this.m_context},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"_callback",{get:function(){return this.m_callback},enumerable:!0,configurable:!0}),n.prototype.add=function(n){var t=e.createTraceAction(this.m_context,null,!1);return this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:t.actionInfo.Id,handler:n,operation:0}),new ct(this.m_context,this,n)},n.prototype.remove=function(n){var t=e.createTraceAction(this.m_context,null,!1);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:t.actionInfo.Id,handler:n,operation:1})},n.prototype.removeAll=function(){var n=e.createTraceAction(this.m_context,null,!1);this.m_context._pendingRequest._addPendingEventHandlerAction(this,{id:n.actionInfo.Id,handler:null,operation:2})},n.prototype._processRegistration=function(n){var f=this,u=t._createPromiseFromResult(null),e=n._getPendingEventHandlerActions(this),r,s,i,o;if(!e)return u;for(r=[],i=0;i<this.m_handlers.length;i++)r.push(this.m_handlers[i]);for(s=!1,i=0;i<e.length;i++)if(n._responseTraceIds[e[i].id]){s=!0;switch(e[i].operation){case 0:r.push(e[i].handler);break;case 1:for(o=r.length-1;o>=0;o--)if(r[o]===e[i].handler){r.splice(o,1);break}break;case 2:r=[];break}}return s&&(!this.m_registered&&r.length>0?u=u.then(function(){return f.m_eventInfo.registerFunc(f.m_callback)}).then(function(){return f.m_registered=!0}):this.m_registered&&r.length==0&&(u=u.then(function(){return f.m_eventInfo.unregisterFunc(f.m_callback)}).catch(function(n){t.log("Error when unregister event: "+JSON.stringify(n))}).then(function(){return f.m_registered=!1})),u=u.then(function(){return f.m_handlers=r})),u},n.prototype.fireEvent=function(n){for(var u,f,r=[],i=0;i<this.m_handlers.length;i++)u=this.m_handlers[i],f=t._createPromiseFromResult(null).then(this.createFireOneEventHandlerFunc(u,n)).catch(function(n){t.log("Error when invoke handler: "+JSON.stringify(n))}),r.push(f);t.Promise.all(r)},n.prototype.createFireOneEventHandlerFunc=function(n,t){return function(){return n(t)}},n}();n.EventHandlers=vt;ct=function(){function n(n,t,i){this.m_context=n;this.m_allHandlers=t;this.m_handler=i}return Object.defineProperty(n.prototype,"context",{get:function(){return this.m_context},enumerable:!0,configurable:!0}),n.prototype.remove=function(){this.m_allHandlers&&this.m_handler&&(this.m_allHandlers.remove(this.m_handler),this.m_allHandlers=null,this.m_handler=null)},n}();n.EventHandlerResult=ct,function(n){var t=function(){function t(){}return t.prototype.register=function(t,r,u){switch(t){case 4:return i.promisify(function(n){return Office.context.document.bindings.getByIdAsync(r,n)}).then(function(n){return i.promisify(function(t){return n.addHandlerAsync(Office.EventType.BindingDataChanged,u,t)})});case 3:return i.promisify(function(n){return Office.context.document.bindings.getByIdAsync(r,n)}).then(function(n){return i.promisify(function(t){return n.addHandlerAsync(Office.EventType.BindingSelectionChanged,u,t)})});case 2:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,u,n)});case 1:return i.promisify(function(n){return Office.context.document.settings.addHandlerAsync(Office.EventType.SettingsChanged,u,n)});case 5:return i.promisify(function(n){return OSF.DDA.RichApi.richApiMessageManager.addHandlerAsync("richApiMessage",u,n)});case 13:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDeleted,u,{id:r},n)});case 14:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.ObjectSelectionChanged,u,{id:r},n)});case 15:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.ObjectDataChanged,u,{id:r},n)});case 16:return i.promisify(function(n){return Office.context.document.addHandlerAsync(Office.EventType.ContentControlAdded,u,{id:r},n)});default:throw n.RuntimeError._createInvalidArgError({argumentName:"eventId"});}},t.prototype.unregister=function(t,r,u){switch(t){case 4:return i.promisify(function(n){return Office.context.document.bindings.getByIdAsync(r,n)}).then(function(n){return i.promisify(function(t){return n.removeHandlerAsync(Office.EventType.BindingDataChanged,{handler:u},t)})});case 3:return i.promisify(function(n){return Office.context.document.bindings.getByIdAsync(r,n)}).then(function(n){return i.promisify(function(t){return n.removeHandlerAsync(Office.EventType.BindingSelectionChanged,{handler:u},t)})});case 2:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.DocumentSelectionChanged,{handler:u},n)});case 1:return i.promisify(function(n){return Office.context.document.settings.removeHandlerAsync(Office.EventType.SettingsChanged,{handler:u},n)});case 5:return i.promisify(function(n){return OSF.DDA.RichApi.richApiMessageManager.removeHandlerAsync("richApiMessage",{handler:u},n)});case 13:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDeleted,{id:r,handler:u},n)});case 14:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectSelectionChanged,{id:r,handler:u},n)});case 15:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.ObjectDataChanged,{id:r,handler:u},n)});case 16:return i.promisify(function(n){return Office.context.document.removeHandlerAsync(Office.EventType.ContentControlAdded,{id:r,handler:u},n)});default:throw n.RuntimeError._createInvalidArgError({argumentName:"eventId"});}},t}();n.officeJsEventRegistration=new t}(r=n._Internal||(n._Internal={}));lt=function(){function n(n,t){this.m_handlersByEventByTarget={};this.m_registerEventImpl=n;this.m_unregisterEventImpl=t}return n.prototype.getHandlers=function(n,t){var r,u;return i.isNullOrUndefined(t)&&(t=""),r=this.m_handlersByEventByTarget[n],r||(r={},this.m_handlersByEventByTarget[n]=r),u=r[t],u||(u=[],r[t]=u),u},n.prototype.register=function(n,t,u){if(!u)throw r.RuntimeError._createInvalidArgError({argumentName:"handler"});var f=this.getHandlers(n,t);return(f.push(u),f.length===1)?this.m_registerEventImpl(n,t):i._createPromiseFromResult(null)},n.prototype.unregister=function(n,t,u){var f,e;if(!u)throw r.RuntimeError._createInvalidArgError({argumentName:"handler"});for(f=this.getHandlers(n,t),e=f.length-1;e>=0;e--)if(f[e]===u){f.splice(e,1);break}return f.length===0?this.m_unregisterEventImpl(n,t):i._createPromiseFromResult(null)},n}();n.EventRegistration=lt;w=function(){function n(){this.m_eventRegistration=new lt(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this));this.m_richApiMessageHandler=this._handleRichApiMessage.bind(this)}return n.prototype.ready=function(){var t=this;return this.m_ready||(this.m_ready=n._testReadyImpl?n._testReadyImpl().then(function(){t.m_isReady=!0}):d.instance?i._createPromiseFromResult(null).then(function(){t.m_isReady=!0}):r.officeJsEventRegistration.register(5,"",this.m_richApiMessageHandler).then(function(){t.m_isReady=!0})),this.m_ready},Object.defineProperty(n.prototype,"isReady",{get:function(){return this.m_isReady},enumerable:!0,configurable:!0}),n.prototype.register=function(n,t,i){var r=this;return this.ready().then(function(){return r.m_eventRegistration.register(n,t,i)})},n.prototype.unregister=function(n,t,i){var r=this;return this.ready().then(function(){return r.m_eventRegistration.unregister(n,t,i)})},n.prototype._registerEventImpl=function(n,t){return i._createPromiseFromResult(null)},n.prototype._unregisterEventImpl=function(n,t){return i._createPromiseFromResult(null)},n.prototype._handleRichApiMessage=function(n){var r,i,f,o,e;if(n&&n.entries)for(r=0;r<n.entries.length;r++)if(i=n.entries[r],i.messageCategory==u.eventMessageCategory&&(t._logEnabled&&t.log(JSON.stringify(i)),f=this.m_eventRegistration.getHandlers(i.messageType,i.targetId),f.length>0))for(o=JSON.parse(i.message),i.isRemoteOverride&&(o.source=u.eventSourceRemote),e=0;e<f.length;e++)f[e](o)},n.getGenericEventRegistration=function(){return n.s_genericEventRegistration||(n.s_genericEventRegistration=new n),n.s_genericEventRegistration},n.richApiMessageEventCategory=65536,n}();n._testSetRichApiMessageReadyImpl=hi;n._testTriggerRichApiMessageEvent=ci;ii=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.m_genericEventInfo=u,f}return __extends(t,n),t.prototype.add=function(n){var t=this;return this._handlers.length==0&&this.m_genericEventInfo.registerFunc&&this.m_genericEventInfo.registerFunc(),w.getGenericEventRegistration().isReady||this._context._pendingRequest._addPreSyncPromise(w.getGenericEventRegistration().ready()),e.createTraceMarkerForCallback(this._context,function(){t._handlers.push(n);t._handlers.length==1&&w.getGenericEventRegistration().register(t.m_genericEventInfo.eventType,t.m_genericEventInfo.getTargetIdFunc(),t._callback)}),new ct(this._context,this,n)},t.prototype.remove=function(n){var t=this;this._handlers.length==1&&this.m_genericEventInfo.unregisterFunc&&this.m_genericEventInfo.unregisterFunc();e.createTraceMarkerForCallback(this._context,function(){for(var i=t._handlers,r=i.length-1;r>=0;r--)if(i[r]===n){i.splice(r,1);break}i.length==0&&w.getGenericEventRegistration().unregister(t.m_genericEventInfo.eventType,t.m_genericEventInfo.getTargetIdFunc(),t._callback)})},t.prototype.removeAll=function(){},t}(vt);n.GenericEventHandlers=ii;ri=function(){function n(n){this.m_clientObject=n}return n.prototype._handleResult=function(n){this.m_clientObject._handleIdResult(n)},n}();b=function(){function n(){}return n.createGlobalObjectObjectPath=function(n){var t={Id:n._nextId(),ObjectPathType:1,Name:""};return new l(t,null,!1,!1,1,4)},n.createNewObjectObjectPath=function(n,t,r,u){var f={Id:n._nextId(),ObjectPathType:2,Name:t};return new l(f,null,r,!1,1,i._fixupApiFlags(u))},n.createPropertyObjectPath=function(n,t,r,u,f,e){var o={Id:n._nextId(),ObjectPathType:4,Name:r,ParentObjectPathId:t._objectPath.objectPathInfo.Id};return new l(o,t._objectPath,u,f,1,i._fixupApiFlags(e))},n.createIndexerObjectPath=function(n,t,i){var r={Id:n._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}};return r.ArgumentInfo.Arguments=i,new l(r,t._objectPath,!1,!1,1,4)},n.createIndexerObjectPathUsingParentPath=function(n,t,i){var r={Id:n._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t.objectPathInfo.Id,ArgumentInfo:{}};return r.ArgumentInfo.Arguments=i,new l(r,t,!1,!1,1,4)},n.createMethodObjectPath=function(n,t,r,u,f,e,o,s,h){var a={Id:n._nextId(),ObjectPathType:3,Name:r,ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},v=i.setMethodArguments(n,a.ArgumentInfo,f),c=new l(a,t._objectPath,e,o,u,i._fixupApiFlags(h));return c.argumentObjectPaths=v,c.getByIdMethodName=s,c},n.createReferenceIdObjectPath=function(n,t){var i={Id:n._nextId(),ObjectPathType:6,Name:t,ArgumentInfo:{}};return new l(i,null,!1,!1,1,4)},n.createChildItemObjectPathUsingIndexerOrGetItemAt=function(t,r,u,f,e){var o=i.tryGetObjectIdFromLoadOrRetrieveResult(f);return t&&!i.isNullOrUndefined(o)?n.createChildItemObjectPathUsingIndexer(r,u,f):n.createChildItemObjectPathUsingGetItemAt(r,u,f,e)},n.createChildItemObjectPathUsingIndexer=function(n,t,r){var f=i.tryGetObjectIdFromLoadOrRetrieveResult(r),u=u={Id:n._nextId(),ObjectPathType:5,Name:"",ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}};return u.ArgumentInfo.Arguments=[f],new l(u,t._objectPath,!1,!1,1,4)},n.createChildItemObjectPathUsingGetItemAt=function(n,t,i,r){var e=i[u.index],f;return e&&(r=e),f={Id:n._nextId(),ObjectPathType:3,Name:u.getItemAt,ParentObjectPathId:t._objectPath.objectPathInfo.Id,ArgumentInfo:{}},f.ArgumentInfo.Arguments=[r],new l(f,t._objectPath,!1,!1,1,4)},n}();n.ObjectPathFactory=b;ui=function(){function i(n){this.m_context=n}return i.prototype.executeAsync=function(r,u,f){var e=this,o=c.buildMessageArrayForIRequestExecutor(r,u,f,i.SourceLibHeaderValue);return new n.Promise(function(n,i){OSF.DDA.RichApi.executeRichApiRequestAsync(o,function(i){t.log("Response:");t.log(JSON.stringify(i));var r;i.status=="succeeded"?r=c.buildResponseOnSuccess(c.getResponseBody(i),c.getResponseHeaders(i)):(r=c.buildResponseOnError(i.error.code,i.error.message),e.m_context._processOfficeJsErrorResponse(i.error.code,r));n(r)})})},i.SourceLibHeaderValue="officejs",i}();yt=function(){function n(n){this._autoCleanupList={};this.m_context=n}return n.prototype.add=function(n){var t=this;Array.isArray(n)?n.forEach(function(n){return t._addCommon(n,!0)}):this._addCommon(n,!0)},n.prototype._autoAdd=function(n){this._addCommon(n,!1);this._autoCleanupList[n._objectPath.objectPathInfo.Id]=n},n.prototype._autoTrackIfNecessaryWhenHandleObjectResultValue=function(n,t){var r=this.m_context._autoCleanup&&!n[u.isTracked]&&n!==this.m_context._rootObject&&t&&!i.isNullOrEmptyString(t[u.referenceId]);r&&(this._autoCleanupList[n._objectPath.objectPathInfo.Id]=n,n[u.isTracked]=!0)},n.prototype._addCommon=function(n,r){if(n[u.isTracked]){r&&this.m_context._autoCleanup&&delete this._autoCleanupList[n._objectPath.objectPathInfo.Id];return}var s=n[u.referenceId],h=n._objectPath.objectPathInfo[u.objectPathInfoDoNotKeepReferenceFieldName];if(h)throw i.createRuntimeError(f.generalException,t._getResourceString(o.objectIsUntracked),null);i.isNullOrEmptyString(s)&&n._KeepReference&&(n._KeepReference(),e.createInstantiateAction(this.m_context,n),r&&this.m_context._autoCleanup&&delete this._autoCleanupList[n._objectPath.objectPathInfo.Id],n[u.isTracked]=!0)},n.prototype.remove=function(n){var t=this;Array.isArray(n)?n.forEach(function(n){return t._removeCommon(n)}):this._removeCommon(n)},n.prototype._removeCommon=function(n){var t,r;n._objectPath.objectPathInfo[u.objectPathInfoDoNotKeepReferenceFieldName]=!0;n.context._pendingRequest._removeKeepReferenceAction(n._objectPath.objectPathInfo.Id);t=n[u.referenceId];i.isNullOrEmptyString(t)||(r=this.m_context._rootObject,r._RemoveReference&&r._RemoveReference(t));delete n[u.isTracked]},n.prototype._retrieveAndClearAutoCleanupList=function(){var n=this._autoCleanupList;return this._autoCleanupList={},n},n}();n.TrackedObjects=yt;at=function(){function t(n,t,i,r,u){n||(n="root");this.m_globalObjName=n;this.m_referencedObjectPaths=t;this.m_actions=i;this.m_statements=[];this.m_variableNameForObjectPathMap={};this.m_variableNameToObjectPathMap={};this.m_declaredObjectPathMap={};this.m_showDispose=r;this.m_removePII=u}return t.prototype.process=function(){this.m_showDispose&&tt._calculateLastUsedObjectPathIds(this.m_actions);for(var n=0;n<this.m_actions.length;n++)this.processOneAction(this.m_actions[n]);return this.m_statements},t.prototype.processForDebugStatementInfo=function(n){var e,h,t,r,u,f,i,o,s;for(this.m_showDispose&&tt._calculateLastUsedObjectPathIds(this.m_actions),e=5,this.m_statements=[],h="",t=-1,r=0;r<this.m_actions.length;r++)if(this.processOneAction(this.m_actions[r]),n==r&&(t=this.m_statements.length-1),t>=0&&this.m_statements.length>t+e+1)break;if(t<0)return null;for(u=t-e,u<0&&(u=0),f=t+1+e,f>this.m_statements.length&&(f=this.m_statements.length),i=[],u!=0&&i.push("..."),o=u;o<t;o++)i.push(this.m_statements[o]);for(i.push("// >>>>>"),i.push(this.m_statements[t]),i.push("// <<<<<"),s=t+1;s<f;s++)i.push(this.m_statements[s]);return f<this.m_statements.length&&i.push("..."),{statement:this.m_statements[t],surroundingStatements:i}},t.prototype.processOneAction=function(n){var t=n.actionInfo;switch(t.ActionType){case 1:this.processInstantiateAction(n);break;case 3:this.processMethodAction(n);break;case 2:this.processQueryAction(n);break;case 7:this.processQueryAsJsonAction(n);break;case 6:this.processRecursiveQueryAction(n);break;case 4:this.processSetPropertyAction(n);break;case 5:this.processTraceAction(n);break;case 8:this.processEnsureUnchangedAction(n);break;case 9:this.processUpdateAction(n);break}},t.prototype.processInstantiateAction=function(n){var i=n.actionInfo.ObjectPathId,u=this.m_referencedObjectPaths[i],r=this.getObjVarName(i),t;this.m_declaredObjectPathMap[i]?(t="// Instantiate {"+r+"}",t=this.appendDisposeCommentIfRelevant(t,n),this.m_statements.push(t)):(t="var "+r+"="+this.buildObjectPathExpressionWithParent(u)+";",t=this.appendDisposeCommentIfRelevant(t,n),this.m_statements.push(t),this.m_declaredObjectPathMap[i]=r)},t.prototype.processMethodAction=function(t){var u=t.actionInfo.Name,r;if(u==="_KeepReference"){if(!n._internalConfig.showInternalApiInDebugInfo)return;u="track"}r=this.getObjVarName(t.actionInfo.ObjectPathId)+"."+i._toCamelLowerCase(u)+"("+this.buildArgumentsExpression(t.actionInfo.ArgumentInfo)+");";r=this.appendDisposeCommentIfRelevant(r,t);this.m_statements.push(r)},t.prototype.processQueryAction=function(n){var i=this.buildQueryExpression(n),t=this.getObjVarName(n.actionInfo.ObjectPathId)+".load("+i+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processQueryAsJsonAction=function(n){var i=this.buildQueryExpression(n),t=this.getObjVarName(n.actionInfo.ObjectPathId)+".retrieve("+i+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processRecursiveQueryAction=function(n){var i="",t;n.actionInfo.RecursiveQueryInfo&&(i=JSON.stringify(n.actionInfo.RecursiveQueryInfo));t=this.getObjVarName(n.actionInfo.ObjectPathId)+".loadRecursive("+i+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processSetPropertyAction=function(n){var t=this.getObjVarName(n.actionInfo.ObjectPathId)+"."+i._toCamelLowerCase(n.actionInfo.Name)+"="+this.buildArgumentsExpression(n.actionInfo.ArgumentInfo)+";";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processTraceAction=function(n){var t="context.trace();";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processEnsureUnchangedAction=function(n){var t=this.getObjVarName(n.actionInfo.ObjectPathId)+".ensureUnchanged("+JSON.stringify(n.actionInfo.ObjectState)+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.processUpdateAction=function(n){var t=this.getObjVarName(n.actionInfo.ObjectPathId)+".update("+JSON.stringify(n.actionInfo.ObjectState)+");";t=this.appendDisposeCommentIfRelevant(t,n);this.m_statements.push(t)},t.prototype.appendDisposeCommentIfRelevant=function(n,t){var u=this,i,r;return this.m_showDispose&&(i=t.actionInfo.L,i&&i.length>0)?(r=i.map(function(n){return u.getObjVarName(n)}).join(", "),n+" // And then dispose {"+r+"}"):n},t.prototype.buildQueryExpression=function(n){if(n.actionInfo.QueryInfo){var t={};return t.select=n.actionInfo.QueryInfo.Select,t.expand=n.actionInfo.QueryInfo.Expand,t.skip=n.actionInfo.QueryInfo.Skip,t.top=n.actionInfo.QueryInfo.Top,typeof t.top=="undefined"&&typeof t.skip=="undefined"&&typeof t.expand=="undefined"?typeof t.select=="undefined"?"":JSON.stringify(t.select):JSON.stringify(t)}return""},t.prototype.buildObjectPathExpressionWithParent=function(n){var t=n.objectPathInfo.ObjectPathType==5||n.objectPathInfo.ObjectPathType==3||n.objectPathInfo.ObjectPathType==4;return t&&n.objectPathInfo.ParentObjectPathId?this.getObjVarName(n.objectPathInfo.ParentObjectPathId)+"."+this.buildObjectPathExpression(n):this.buildObjectPathExpression(n)},t.prototype.buildObjectPathExpression=function(n){var t=this.buildObjectPathInfoExpression(n.objectPathInfo),i=n.originalObjectPathInfo;return i&&(t=t+" /* originally "+this.buildObjectPathInfoExpression(i)+" */"),t},t.prototype.buildObjectPathInfoExpression=function(n){switch(n.ObjectPathType){case 1:return"context."+this.m_globalObjName;case 5:return"getItem("+this.buildArgumentsExpression(n.ArgumentInfo)+")";case 3:return i._toCamelLowerCase(n.Name)+"("+this.buildArgumentsExpression(n.ArgumentInfo)+")";case 2:return n.Name+".newObject()";case 7:return"null";case 4:return i._toCamelLowerCase(n.Name);case 6:return"context."+this.m_globalObjName+"._getObjectByReferenceId("+JSON.stringify(n.Name)+")"}},t.prototype.buildArgumentsExpression=function(n){var t="",i;if(!n.Arguments||n.Arguments.length===0)return t;if(this.m_removePII)return typeof n.Arguments[0]=="undefined"?t:"...";for(i=0;i<n.Arguments.length;i++)i>0&&(t=t+", "),t=t+this.buildArgumentLiteral(n.Arguments[i],n.ReferencedObjectPathIds?n.ReferencedObjectPathIds[i]:null);return t==="undefined"&&(t=""),t},t.prototype.buildArgumentLiteral=function(n,t){return typeof n=="number"&&n===t?this.getObjVarName(t):JSON.stringify(n)},t.prototype.getObjVarNameBase=function(n){var u="v",f=this.m_referencedObjectPaths[n],t,r;if(f)switch(f.objectPathInfo.ObjectPathType){case 1:u=this.m_globalObjName;break;case 4:u=i._toCamelLowerCase(f.objectPathInfo.Name);break;case 3:t=f.objectPathInfo.Name;t.length>3&&t.substr(0,3)==="Get"&&(t=t.substr(3));u=i._toCamelLowerCase(t);break;case 5:r=this.getObjVarNameBase(f.objectPathInfo.ParentObjectPathId);u=r.charAt(r.length-1)==="s"?r.substr(0,r.length-1):r+"Item";break}return u},t.prototype.getObjVarName=function(n){var t,i;if(this.m_variableNameForObjectPathMap[n])return this.m_variableNameForObjectPathMap[n];if(t=this.getObjVarNameBase(n),!this.m_variableNameToObjectPathMap[t])return this.m_variableNameForObjectPathMap[n]=t,this.m_variableNameToObjectPathMap[t]=n,t;for(i=1;this.m_variableNameToObjectPathMap[t+i.toString()];)i++;return t=t+i.toString(),this.m_variableNameForObjectPathMap[n]=t,this.m_variableNameToObjectPathMap[t]=n,t},t}();o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.cannotRegisterEvent="CannotRegisterEvent",t.connectionFailureWithStatus="ConnectionFailureWithStatus",t.connectionFailureWithDetails="ConnectionFailureWithDetails",t.propertyNotLoaded="PropertyNotLoaded",t.runMustReturnPromise="RunMustReturnPromise",t.propertyDoesNotExist="PropertyDoesNotExist",t.attemptingToSetReadOnlyProperty="AttemptingToSetReadOnlyProperty",t.moreInfoInnerError="MoreInfoInnerError",t.cannotApplyPropertyThroughSetMethod="CannotApplyPropertyThroughSetMethod",t.invalidOperationInCellEditMode="InvalidOperationInCellEditMode",t.objectIsUntracked="ObjectIsUntracked",t.customFunctionDefintionMissing="CustomFunctionDefintionMissing",t.customFunctionImplementationMissing="CustomFunctionImplementationMissing",t.customFunctionNameContainsBadChars="CustomFunctionNameContainsBadChars",t.customFunctionNameCannotSplit="CustomFunctionNameCannotSplit",t.customFunctionUnexpectedNumberOfEntriesInResultBatch="CustomFunctionUnexpectedNumberOfEntriesInResultBatch",t.customFunctionCancellationHandlerMissing="CustomFunctionCancellationHandlerMissing",t.customFunctionInvalidFunction="CustomFunctionInvalidFunction",t.customFunctionInvalidFunctionMapping="CustomFunctionInvalidFunctionMapping",t.customFunctionWindowMissing="CustomFunctionWindowMissing",t.customFunctionDefintionMissingOnWindow="CustomFunctionDefintionMissingOnWindow",t.pendingBatchInProgress="PendingBatchInProgress",t.notInsideBatch="NotInsideBatch",t.cannotUpdateReadOnlyProperty="CannotUpdateReadOnlyProperty",t}(h);n.ResourceStrings=o;t.addResourceStringValues({CannotRegisterEvent:"The event handler cannot be registered.",PropertyNotLoaded:"The property '{0}' is not available. Before reading the property's value, call the load method on the containing object and call \"context.sync()\" on the associated request context.",RunMustReturnPromise:'The batch function passed to the ".run" method didn\'t return a promise. The function must return a promise, so that any automatically-tracked objects can be released at the completion of the batch operation. Typically, you return a promise by returning the response from "context.sync()".',InvalidOrTimedOutSessionMessage:"Your Office Online session has expired or is invalid. To continue, refresh the page.",InvalidOperationInCellEditMode:"Excel is in cell-editing mode. Please exit the edit mode by pressing ENTER or TAB or selecting another cell, and then try again.",CustomFunctionDefintionMissing:"A property with the name '{0}' that represents the function's definition must exist on Excel.Script.CustomFunctions.",CustomFunctionDefintionMissingOnWindow:"A property with the name '{0}' that represents the function's definition must exist on the window object.",CustomFunctionImplementationMissing:"The property with the name '{0}' on Excel.Script.CustomFunctions that represents the function's definition must contain a 'call' property that implements the function.",CustomFunctionNameContainsBadChars:"The function name may only contain letters, digits, underscores, and periods.",CustomFunctionNameCannotSplit:"The function name must contain a non-empty namespace and a non-empty short name.",CustomFunctionUnexpectedNumberOfEntriesInResultBatch:"The batching function returned a number of results that doesn't match the number of parameter value sets that were passed into it.",CustomFunctionCancellationHandlerMissing:"The cancellation handler onCanceled is missing in the function. The handler must be present as the function is defined as cancelable.",CustomFunctionInvalidFunction:"The property with the name '{0}' that represents the function's definition is not a valid function.",CustomFunctionInvalidFunctionMapping:"The property with the name '{0}' on CustomFunctionMappings that represents the function's definition is not a valid function.",CustomFunctionWindowMissing:"The window object was not found.",PendingBatchInProgress:"There is a pending batch in progress. The batch method may not be called inside another batch, or simultaneously with another batch.",NotInsideBatch:"Operations may not be invoked outside of a batch method.",CannotUpdateReadOnlyProperty:"The property '{0}' is read-only and it cannot be updated.",ObjectIsUntracked:"The object is untracked."});i=function(i){function f(){return i!==null&&i.apply(this,arguments)||this}return __extends(f,i),f.fixObjectPathIfNecessary=function(n,t){n&&n._objectPath&&t&&n._objectPath.updateUsingObjectData(t,n)},f.validateObjectPath=function(n){for(var i=n._objectPath;i;){if(!i.isValid)throw new r.RuntimeError({code:g.invalidObjectPath,message:t._getResourceString(o.invalidObjectPath,f.getObjectPathExpression(i)),debugInfo:{errorLocation:f.getObjectPathExpression(i)}});i=i.parentObjectPath}},f.validateReferencedObjectPaths=function(n){var u,i;if(n)for(u=0;u<n.length;u++)for(i=n[u];i;){if(!i.isValid)throw new r.RuntimeError({code:g.invalidObjectPath,message:t._getResourceString(o.invalidObjectPath,f.getObjectPathExpression(i))});i=i.parentObjectPath}},f.load=function(n,t){return n.context.load(n,t),n},f.loadAndSync=function(n,t){return n.context.load(n,t),n.context.sync().then(function(){return n})},f.retrieve=function(t,i){var r=n._internalConfig.alwaysPolyfillClientObjectRetrieveMethod,u,o,s;return r||(r=!f.isSetSupported("RichApiRuntime","1.1")),u=new ti(t,r),o=ni._parseQueryOption(i),s=r?e.createQueryAction(t.context,t,o):e.createQueryAsJsonAction(t.context,t,o),t.context._pendingRequest.addActionResultHandler(s,u),u},f.retrieveAndSync=function(n,t){var i=f.retrieve(n,t);return n.context.sync().then(function(){return i})},f._parseSelectExpand=function(n){function e(n){var t=n.toLowerCase(),i,r;return t==="items"||t==="items/"?"*":(i=6,r=t.substr(0,i)==="items/"||t.substr(0,i)==="items.",r&&(n=n.substr(i)),n.replace(new RegExp("[/.]items[/.]","gi"),"/"))}var f=[],u,r,i;if(!t.isNullOrEmptyString(n))for(u=n.split(","),r=0;r<u.length;r++)i=u[r],i=e(i.trim()),i.length>0&&f.push(i);return f},f.toJson=function(n,t,i,r){var o={},e,u;for(e in t)u=t[e],typeof u!="undefined"&&(o[e]=u);for(e in i)u=i[e],typeof u!="undefined"&&(o[e]=u[f.fieldName_isCollection]&&typeof u[f.fieldName_m__items]!="undefined"?u.toJSON().items:u.toJSON());return r&&(o.items=r.map(function(n){return n.toJSON()})),o},f.throwError=function(n,i,u){throw new r.RuntimeError({code:n,message:t._getResourceString(n,i),debugInfo:u?{errorLocation:u}:undefined});},f.createRuntimeError=function(n,t,i){return new r.RuntimeError({code:n,message:t,debugInfo:{errorLocation:i}})},f.throwIfNotLoaded=function(n,i,r,u){if(!u&&t.isUndefined(i)&&n.charCodeAt(0)!=f.s_underscoreCharCode)throw f.createPropertyNotLoadedException(r,n);},f.createPropertyNotLoadedException=function(n,i){return new r.RuntimeError({code:g.propertyNotLoaded,message:t._getResourceString(o.propertyNotLoaded,i),debugInfo:n?{errorLocation:n+"."+i}:undefined})},f.createCannotUpdateReadOnlyPropertyException=function(n,i){return new r.RuntimeError({code:g.cannotUpdateReadOnlyProperty,message:t._getResourceString(o.cannotUpdateReadOnlyProperty,i),debugInfo:n?{errorLocation:n+"."+i}:undefined})},f.promisify=function(t){return new n.Promise(function(n,i){var r=function(t){t.status=="failed"?i(t.error):n(t.value)};t(r)})},f._addActionResultHandler=function(n,t,i){n.context._pendingRequest.addActionResultHandler(t,i)},f._handleNavigationPropertyResults=function(n,i,r){for(var u=0;u<r.length-1;u+=2)t.isUndefined(i[r[u+1]])||n[r[u]]._handleResult(i[r[u+1]])},f._toCamelLowerCase=function(n){if(t.isNullOrEmptyString(n))return n;for(var i=0;i<n.length&&n.charCodeAt(i)>=65&&n.charCodeAt(i)<=90;)i++;return i<n.length?n.substr(0,i).toLowerCase()+n.substr(i):n.toLowerCase()},f._fixupApiFlags=function(n){return typeof n=="boolean"&&(n=n?1:0),n},f.definePropertyThrowUnloadedException=function(n,t,i){Object.defineProperty(n,i,{configurable:!0,enumerable:!0,get:function(){throw f.createPropertyNotLoadedException(t,i);},set:function(){throw f.createCannotUpdateReadOnlyPropertyException(t,i);}})},f.defineReadOnlyPropertyWithValue=function(n,t,i){Object.defineProperty(n,t,{configurable:!0,enumerable:!0,get:function(){return i},set:function(){throw f.createCannotUpdateReadOnlyPropertyException(null,t);}})},f.processRetrieveResult=function(n,i,r,e){var l,v,y,a,o,s,c,b,h;if(!t.isNullOrUndefined(i))if(e){if(l=i[u.itemsLowerCase],Array.isArray(l)){for(v=[],o=0;o<l.length;o++)y=e(l[o],o),a={},a[u.proxy]=y,y._handleRetrieveResult(l[o],a),v.push(a);f.defineReadOnlyPropertyWithValue(r,u.itemsLowerCase,v)}}else{var p=n[u.scalarPropertyNames],w=n[u.navigationPropertyNames],k=n[u.className];if(p)for(o=0;o<p.length;o++)s=p[o],c=i[s],t.isUndefined(c)?f.definePropertyThrowUnloadedException(r,k,s):f.defineReadOnlyPropertyWithValue(r,s,c);if(w)for(o=0;o<w.length;o++)s=w[o],c=i[s],t.isUndefined(c)?f.definePropertyThrowUnloadedException(r,k,s):(b=n[s],h={},b._handleRetrieveResult(c,h),h[u.proxy]=b,Array.isArray(h[u.itemsLowerCase])&&(h=h[u.itemsLowerCase]),f.defineReadOnlyPropertyWithValue(r,s,h))}},f.fieldName_m__items="m__items",f.fieldName_isCollection="_isCollection",f._synchronousCleanup=!1,f.s_underscoreCharCode="_".charCodeAt(0),f}(p);n.Utility=i;fi=function(){function n(){}return n.invokeMethod=function(n,t,r,u,f,o){var h=e.createMethodAction(n.context,n,t,r,u,f),s=new rt(o);return i._addActionResultHandler(n,h,s),s},n.invokeEnsureUnchanged=function(n,t){e.createEnsureUnchangedAction(n.context,n,t)},n.invokeSetProperty=function(n,t,i,r){e.createSetPropertyAction(n.context,n,t,i,r)},n.createRootServiceObject=function(n,t){var i=b.createGlobalObjectObjectPath(t);return new n(t,i)},n.createObjectFromReferenceId=function(n,t,i){var r=b.createReferenceIdObjectPath(t,i);return new n(t,r)},n.createTopLevelServiceObject=function(n,t,i,r,u){var f=b.createNewObjectObjectPath(t,i,r,u);return new n(t,f)},n.createPropertyObject=function(n,t,i,r,u){var f=b.createPropertyObjectPath(t.context,t,i,r,!1,u);return new n(t.context,f)},n.createIndexerObject=function(n,t,i){var r=b.createIndexerObjectPath(t.context,t,i);return new n(t.context,r)},n.createMethodObject=function(n,t,i,r,u,f,e,o,s){var h=b.createMethodObjectPath(t.context,t,i,r,u,f,e,o,s);return new n(t.context,h)},n.createChildItemObject=function(n,t,i,r,u){var f=b.createChildItemObjectPathUsingIndexerOrGetItemAt(t,i.context,i,r,u);return new n(i.context,f)},n}();n.BatchApiHelper=fi;pt=1;ft={invokeRequestModifier:function(n){return n.DdaMethod.Version=pt,n},invokeResponseModifier:function(n){return pt=n.Version,n.Error&&(n.error={},n.error.Code=n.Error),n}},function(n){n.SendingId="sId";n.RespondingId="rId";n.CommandKey="command";n.SessionInfoKey="sessionInfo";n.ParamsKey="params";n.ApiReadyCommand="apiready";n.ExecuteMethodCommand="executeMethod";n.GetAppContextCommand="getAppContext";n.RegisterEventCommand="registerEvent";n.UnregisterEventCommand="unregisterEvent";n.FireEventCommand="fireEvent"}(s||(s={}));nt=function(){function n(){}return n.sessionContext="sc",n.embeddingPageOrigin="EmbeddingPageOrigin",n.embeddingPageSessionInfo="EmbeddingPageSessionInfo",n}();n.EmbeddedConstants=nt;ei=function(n){function r(t,i){var r=n.call(this)||this;return r.m_chosenWindow=null,r.m_chosenOrigin=null,r.m_enabled=!0,r.m_onMessageHandler=r._onMessage.bind(r),r.m_callbackList={},r.m_id=0,r.m_timeoutId=-1,r.m_appContext=null,r.m_url=t,r.m_options=i,r.m_options||(r.m_options={sessionKey:Math.random().toString()}),r.m_options.sessionKey||(r.m_options.sessionKey=Math.random().toString()),r.m_options.container||(r.m_options.container=document.body),r.m_options.timeoutInMilliseconds||(r.m_options.timeoutInMilliseconds=6e4),r.m_options.height||(r.m_options.height="400px"),r.m_options.width||(r.m_options.width="100%"),r.m_options.webApplication&&r.m_options.webApplication.accessToken&&r.m_options.webApplication.accessTokenTtl||(r.m_options.webApplication=null),r}return __extends(r,n),r.prototype._getIFrameSrc=function(){var r=window.location.protocol+"//"+window.location.host,t=nt.embeddingPageOrigin+"="+encodeURIComponent(r)+"&"+nt.embeddingPageSessionInfo+"="+encodeURIComponent(this.m_options.sessionKey),u=!1,n,i;return(this.m_url.toLowerCase().indexOf("/_layouts/preauth.aspx")>0||this.m_url.toLowerCase().indexOf("/_layouts/15/preauth.aspx")>0)&&(u=!0),n=document.createElement("a"),n.href=this.m_url,this.m_options.webApplication?(i=nt.embeddingPageOrigin+"="+r+"&"+nt.embeddingPageSessionInfo+"="+this.m_options.sessionKey,n.search=n.search.length===0||n.search==="?"?"?"+nt.sessionContext+"="+encodeURIComponent(i):n.search+"&"+nt.sessionContext+"="+encodeURIComponent(i)):u?n.hash=n.hash.length===0||n.hash==="#"?"#"+t:n.hash+"&"+t:n.search=n.search.length===0||n.search==="?"?"?"+t:n.search+"&"+t,n.href},r.prototype.init=function(){var n=this,r;return window.addEventListener("message",this.m_onMessageHandler),r=this._getIFrameSrc(),t.createPromise(function(u,e){var o=document.createElement("iframe"),s,c,l;n.m_options.id&&(o.id=n.m_options.id,o.name=n.m_options.id);o.style.height=n.m_options.height;o.style.width=n.m_options.width;n.m_options.webApplication?(s=document.createElement("form"),s.setAttribute("action",r),s.setAttribute("method","post"),s.setAttribute("target",o.name),n.m_options.container.appendChild(s),c=document.createElement("input"),c.setAttribute("type","hidden"),c.setAttribute("name","access_token"),c.setAttribute("value",n.m_options.webApplication.accessToken),s.appendChild(c),l=document.createElement("input"),l.setAttribute("type","hidden"),l.setAttribute("name","access_token_ttl"),l.setAttribute("value",n.m_options.webApplication.accessTokenTtl),s.appendChild(l),n.m_options.container.appendChild(o),s.submit()):(o.src=r,n.m_options.container.appendChild(o));n.m_timeoutId=window.setTimeout(function(){n.close();var r=i.createRuntimeError(f.timeout,t._getResourceString(h.timeout),"EmbeddedSession.init");e(r)},n.m_options.timeoutInMilliseconds);n.m_promiseResolver=u})},r.prototype._invoke=function(n,t,i){if(!this.m_enabled){t(5001,null);return}ft.invokeRequestModifier&&(i=ft.invokeRequestModifier(i));this._sendMessageWithCallback(this.m_id++,n,i,function(n){ft.invokeResponseModifier&&(n=ft.invokeResponseModifier(n));var i=n.Error;delete n.Error;t(i||0,n)})},r.prototype.close=function(){window.removeEventListener("message",this.m_onMessageHandler);window.clearTimeout(this.m_timeoutId);this.m_enabled=!1},Object.defineProperty(r.prototype,"eventRegistration",{get:function(){return this.m_sessionEventManager||(this.m_sessionEventManager=new lt(this._registerEventImpl.bind(this),this._unregisterEventImpl.bind(this))),this.m_sessionEventManager},enumerable:!0,configurable:!0}),r.prototype._createRequestExecutorOrNull=function(){return new oi(this)},r.prototype._resolveRequestUrlAndHeaderInfo=function(){return t._createPromiseFromResult(null)},r.prototype._registerEventImpl=function(n,i){var r=this;return t.createPromise(function(t,u){r._sendMessageWithCallback(r.m_id++,s.RegisterEventCommand,{EventId:n,TargetId:i},function(){t(null)})})},r.prototype._unregisterEventImpl=function(n,i){var r=this;return t.createPromise(function(t,u){r._sendMessageWithCallback(r.m_id++,s.UnregisterEventCommand,{EventId:n,TargetId:i},function(){t()})})},r.prototype._onMessage=function(n){var r=this,t,f,i,e,o;if(this.m_enabled&&(!this.m_chosenWindow||this.m_chosenWindow===n.source&&this.m_chosenOrigin===n.origin)){if(t=n.data,t&&t[s.CommandKey]===s.ApiReadyCommand){!this.m_chosenWindow&&this._isValidDescendant(n.source)&&t[s.SessionInfoKey]===this.m_options.sessionKey&&(this.m_chosenWindow=n.source,this.m_chosenOrigin=n.origin,this._sendMessageWithCallback(this.m_id++,s.GetAppContextCommand,null,function(n){r._setupContext(n);window.clearTimeout(r.m_timeoutId);r.m_promiseResolver()}));return}if(t&&t[s.CommandKey]===s.FireEventCommand){var u=t[s.ParamsKey],h=u.EventId,c=u.TargetId,l=u.Data;if(this.m_sessionEventManager)for(f=this.m_sessionEventManager.getHandlers(h,c),i=0;i<f.length;i++)f[i](l);return}t&&t.hasOwnProperty(s.RespondingId)&&(e=t[s.RespondingId],o=this.m_callbackList[e],typeof o=="function"&&o(t[s.ParamsKey]),delete this.m_callbackList[e])}},r.prototype._sendMessageWithCallback=function(n,t,i,r){this.m_callbackList[n]=r;var u={};u[s.SendingId]=n;u[s.CommandKey]=t;u[s.ParamsKey]=i;this.m_chosenWindow.postMessage(JSON.stringify(u),this.m_chosenOrigin)},r.prototype._isValidDescendant=function(n){function i(t){if(t===n)return!0;for(var r=0,u=t.frames.length;r<u;r++)if(i(t.frames[r]))return!0;return!1}for(var u=this.m_options.container||document.body,r=u.getElementsByTagName("iframe"),t=0,f=r.length;t<f;t++)if(i(r[t].contentWindow))return!0;return!1},r.prototype._setupContext=function(n){!(this.m_appContext=n)},r}(k);n.EmbeddedSession=ei;oi=function(){function n(n){this.m_session=n}return n.prototype.executeAsync=function(i,r,u){var f=this,e=c.buildMessageArrayForIRequestExecutor(i,r,u,n.SourceLibHeaderValue);return t.createPromise(function(i,r){f.m_session._invoke(s.ExecuteMethodCommand,function(n,r){t.log("Response:");t.log(JSON.stringify(r));var u;u=n==0?c.buildResponseOnSuccess(c.getResponseBodyFromSafeArray(r.Data),c.getResponseHeadersFromSafeArray(r.Data)):c.buildResponseOnError(r.error.Code,r.error.Message);i(u)},n._transformMessageArrayIntoParams(e))})},n._transformMessageArrayIntoParams=function(t){return{ArrayData:t,DdaMethod:{DispatchId:n.DispidExecuteRichApiRequestMethod}}},n.DispidExecuteRichApiRequestMethod=93,n.SourceLibHeaderValue="Embedded",n}()}(OfficeExtension||(OfficeExtension={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var h="OfficeCore",c="AgaveVisualApi",l=OfficeExtension.BatchApiHelper.createPropertyObject,a=OfficeExtension.BatchApiHelper.createMethodObject,v=OfficeExtension.BatchApiHelper.createIndexerObject,y=OfficeExtension.BatchApiHelper.createRootServiceObject,i=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,p=OfficeExtension.BatchApiHelper.createChildItemObject,t=OfficeExtension.BatchApiHelper.invokeMethod,w=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,b=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,k=OfficeExtension.Utility.isUndefined,d=OfficeExtension.Utility.throwIfNotLoaded,g=OfficeExtension.Utility.throwIfApiNotSupported,nt=OfficeExtension.Utility.load,tt=OfficeExtension.Utility.retrieve,u=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,it=OfficeExtension.Utility._handleNavigationPropertyResults,rt=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,ut="BiShim",o=function(o){function s(){return o!==null&&o.apply(this,arguments)||this}return __extends(s,o),Object.defineProperty(s.prototype,"_className",{get:function(){return"BiShim"},enumerable:!0,configurable:!0}),s.prototype.initialize=function(n){t(this,"Initialize",0,[n],0,0)},s.prototype.getData=function(){return t(this,"getData",1,[],4,0)},s.prototype.setVisualObjects=function(n){t(this,"setVisualObjects",0,[n],2,0)},s.prototype.setVisualObjectsToPersist=function(n){t(this,"setVisualObjectsToPersist",0,[n],2,0)},s.prototype._handleResult=function(n){if(o.prototype._handleResult.call(this,n),!r(n)){var t=n;f(this,t)}},s.prototype._handleRetrieveResult=function(n,t){o.prototype._handleRetrieveResult.call(this,n,t);e(this,n,t)},s.newObject=function(t){return i(n.BiShim,t,"Microsoft.AgaveVisual.BiShim",!1,4)},s.prototype.toJSON=function(){return u(this,{},{})},s}(OfficeExtension.ClientObject),s;n.BiShim=o,function(n){n.generalException="GeneralException"}(s=n.AgaveVisualErrorCodes||(n.AgaveVisualErrorCodes={}))}(OfficeCore||(OfficeCore={})),function(n){var k="OfficeCore",d="ExperimentApi",g=OfficeExtension.BatchApiHelper.createPropertyObject,i=OfficeExtension.BatchApiHelper.createMethodObject,nt=OfficeExtension.BatchApiHelper.createIndexerObject,tt=OfficeExtension.BatchApiHelper.createRootServiceObject,h=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,it=OfficeExtension.BatchApiHelper.createChildItemObject,t=OfficeExtension.BatchApiHelper.invokeMethod,c=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,rt=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,l=OfficeExtension.Utility.isUndefined,a=OfficeExtension.Utility.throwIfNotLoaded,ut=OfficeExtension.Utility.throwIfApiNotSupported,v=OfficeExtension.Utility.load,y=OfficeExtension.Utility.retrieve,u=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,ft=OfficeExtension.Utility._handleNavigationPropertyResults,et=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,ot="FlightingService",p=function(o){function s(){return o!==null&&o.apply(this,arguments)||this}return __extends(s,o),Object.defineProperty(s.prototype,"_className",{get:function(){return"FlightingService"},enumerable:!0,configurable:!0}),s.prototype.getClientSessionId=function(){return t(this,"GetClientSessionId",1,[],4,0)},s.prototype.getDeferredFlights=function(){return t(this,"GetDeferredFlights",1,[],4,0)},s.prototype.getFeature=function(t,r,u,f){return i(n.ABType,this,"GetFeature",1,[t,r,u,f],!1,!1,null,4)},s.prototype.getFeatureGate=function(t,r){return i(n.ABType,this,"GetFeatureGate",1,[t,r],!1,!1,null,4)},s.prototype.resetOverride=function(n){t(this,"ResetOverride",0,[n],0,0)},s.prototype.setOverride=function(n,i,r){t(this,"SetOverride",0,[n,i,r],0,0)},s.prototype._handleResult=function(n){if(o.prototype._handleResult.call(this,n),!r(n)){var t=n;f(this,t)}},s.prototype._handleRetrieveResult=function(n,t){o.prototype._handleRetrieveResult.call(this,n,t);e(this,n,t)},s.newObject=function(t){return h(n.FlightingService,t,"Microsoft.Experiment.FlightingService",!1,4)},s.prototype.toJSON=function(){return u(this,{},{})},s}(OfficeExtension.ClientObject),o,s,w,b;n.FlightingService=p;o="ABType";s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"_className",{get:function(){return"ABType"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_scalarPropertyNames",{get:function(){return["value"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return a("value",this._V,o,this._isNull),this._V},enumerable:!0,configurable:!0}),t.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!r(t)){var i=t;f(this,i);l(i.Value)||(this._V=i.Value)}},t.prototype.load=function(n){return v(this,n)},t.prototype.retrieve=function(n){return y(this,n)},t.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);e(this,t,i)},t.prototype.toJSON=function(){return u(this,{value:this._V},{})},t.prototype.ensureUnchanged=function(n){c(this,n);return},t}(OfficeExtension.ClientObject);n.ABType=s,function(n){n.boolean="Boolean";n.integer="Integer";n.string="String"}(w=n.FeatureType||(n.FeatureType={})),function(n){n.generalException="GeneralException"}(b=n.ExperimentErrorCodes||(n.ExperimentErrorCodes={}))}(OfficeCore||(OfficeCore={})),function(n){function r(t,i){return OfficeExtension.ClientRequestContext._runBatch("OfficeCore.run",arguments,function(t){return new n.RequestContext(t)})}var t=function(){function t(n){this.context=n}return Object.defineProperty(t.prototype,"authentication",{get:function(){return this.m_authentication||(this.m_authentication=n.AuthenticationService.newObject(this.context)),this.m_authentication},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roamingSettings",{get:function(){return this.m_roamingSettings||(this.m_roamingSettings=n.AuthenticationService.newObject(this.context).roamingSettings),this.m_roamingSettings},enumerable:!0,configurable:!0}),t}(),i;n.FirstPartyApis=t;i=function(i){function r(n){return i.call(this,n)||this}return __extends(r,i),Object.defineProperty(r.prototype,"firstParty",{get:function(){return this.m_firstPartyApis||(this.m_firstPartyApis=new t(this)),this.m_firstPartyApis},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"flighting",{get:function(){return this.flightingService},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"telemetry",{get:function(){return this.m_telemetry||(this.m_telemetry=n.TelemetryService.newObject(this)),this.m_telemetry},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bi",{get:function(){return this.m_biShim||(this.m_biShim=n.BiShim.newObject(this)),this.m_biShim},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"flightingService",{get:function(){return this.m_flightingService||(this.m_flightingService=n.FlightingService.newObject(this)),this.m_flightingService},enumerable:!0,configurable:!0}),r}(OfficeExtension.ClientRequestContext);n.RequestContext=i;n.run=r}(OfficeCore||(OfficeCore={})),function(n){var h="OfficeCore",c="TelemetryApi",l=OfficeExtension.BatchApiHelper.createPropertyObject,a=OfficeExtension.BatchApiHelper.createMethodObject,v=OfficeExtension.BatchApiHelper.createIndexerObject,y=OfficeExtension.BatchApiHelper.createRootServiceObject,t=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,p=OfficeExtension.BatchApiHelper.createChildItemObject,i=OfficeExtension.BatchApiHelper.invokeMethod,w=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,b=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,k=OfficeExtension.Utility.isUndefined,d=OfficeExtension.Utility.throwIfNotLoaded,g=OfficeExtension.Utility.throwIfApiNotSupported,nt=OfficeExtension.Utility.load,tt=OfficeExtension.Utility.retrieve,u=OfficeExtension.Utility.toJson,f=OfficeExtension.Utility.fixObjectPathIfNecessary,it=OfficeExtension.Utility._handleNavigationPropertyResults,rt=OfficeExtension.Utility.adjustToDateTime,e=OfficeExtension.Utility.processRetrieveResult,ut="TelemetryService",o=function(o){function s(){return o!==null&&o.apply(this,arguments)||this}return __extends(s,o),Object.defineProperty(s.prototype,"_className",{get:function(){return"TelemetryService"},enumerable:!0,configurable:!0}),s.prototype.sendTelemetryEvent=function(n,t,r,u,f){i(this,"SendTelemetryEvent",1,[n,t,r,u,f],4,0)},s.prototype._handleResult=function(n){if(o.prototype._handleResult.call(this,n),!r(n)){var t=n;f(this,t)}},s.prototype._handleRetrieveResult=function(n,t){o.prototype._handleRetrieveResult.call(this,n,t);e(this,n,t)},s.newObject=function(i){return t(n.TelemetryService,i,"Microsoft.Telemetry.TelemetryService",!1,4)},s.prototype.toJSON=function(){return u(this,{},{})},s}(OfficeExtension.ClientObject),s;n.TelemetryService=o,function(n){n.generalException="GeneralException"}(s=n.TelemetryErrorCodes||(n.TelemetryErrorCodes={}))}(OfficeCore||(OfficeCore={})),function(n){function t(n){var t=new OfficeCore.RequestContext,i=OfficeCore.AuthenticationService.newObject(t),r;return t._customData="WacPartition",OSF._OfficeAppFactory.getHostInfo().hostPlatform=="web"&&OSF._OfficeAppFactory.getHostInfo().hostType=="word"?(r=i.getAccessToken(n,null),t.sync().then(function(){return r.value})):new OfficeExtension.CoreUtility.Promise(function(r,u){var f=i.onTokenReceived.add(function(n){return OfficeExtension.CoreUtility.isNullOrUndefined(n)||(f.remove(),t.sync().catch(function(){}),n.code==0?r(n.tokenValue):u(n.code)),null});t.sync().then(function(){var u=i.getAccessToken(n,i._targetId);return t.sync().then(function(){if(OfficeExtension.CoreUtility.isNullOrUndefined(u.value))return null;var n=u.value.accessToken;OfficeExtension.CoreUtility.isNullOrUndefined(n)||r(u.value)})}).catch(function(n){u(n)})})}function i(){var n=new OfficeCore.RequestContext,i=OfficeCore.AuthenticationService.newObject(n),t;return n._customData="WacPartition",t=i.getPrimaryIdentityInfo(),n.sync().then(function(){return t.value})}n.getAccessToken=t;n.getPrimaryIdentityInfo=i}(OfficeFirstPartyAuth||(OfficeFirstPartyAuth={})),function(n){var p="Office",vt="OfficeSharedApi",h=OfficeExtension.BatchApiHelper.createPropertyObject,c=OfficeExtension.BatchApiHelper.createMethodObject,et=OfficeExtension.BatchApiHelper.createIndexerObject,yt=OfficeExtension.BatchApiHelper.createRootServiceObject,ot=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,w=OfficeExtension.BatchApiHelper.createChildItemObject,f=OfficeExtension.BatchApiHelper.invokeMethod,b=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,v=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,t=OfficeExtension.Utility.isUndefined,i=OfficeExtension.Utility.throwIfNotLoaded,k=OfficeExtension.Utility.throwIfApiNotSupported,l=OfficeExtension.Utility.load,a=OfficeExtension.Utility.retrieve,e=OfficeExtension.Utility.toJson,o=OfficeExtension.Utility.fixObjectPathIfNecessary,d=OfficeExtension.Utility._handleNavigationPropertyResults,g=OfficeExtension.Utility.adjustToDateTime,s=OfficeExtension.Utility.processRetrieveResult,st,ht,nt,y,tt,ct,it,u,rt,ut,ft,lt,at;(function(n){n.organizationAccount="OrganizationAccount";n.microsoftAccount="MicrosoftAccount"})(st=n.IdentityType||(n.IdentityType={}));ht="AuthenticationService";nt=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"_className",{get:function(){return"AuthenticationService"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_navigationPropertyNames",{get:function(){return["roamingSettings"]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_targetId",{get:function(){return this.m_targetId==undefined&&(this.m_targetId=typeof OSF!="undefined"&&OSF.OUtil?OSF.OUtil.Guid.generateNewGuid():""+this.context._nextId()),this.m_targetId},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"roamingSettings",{get:function(){return this._R||(this._R=h(n.RoamingSettingCollection,this,"RoamingSettings",!1,4)),this._R},enumerable:!0,configurable:!0}),i.prototype.getAccessToken=function(n,t){return f(this,"GetAccessToken",1,[n,t],5,0)},i.prototype.getPrimaryIdentityInfo=function(){return k("AuthenticationService.getPrimaryIdentityInfo","FirstPartyAuthentication","1.2",p),f(this,"GetPrimaryIdentityInfo",1,[],5,0)},i.prototype._handleResult=function(n){if(t.prototype._handleResult.call(this,n),!r(n)){var i=n;o(this,i);d(this,i,["roamingSettings","RoamingSettings"])}},i.prototype.load=function(n){return l(this,n)},i.prototype.retrieve=function(n){return a(this,n)},i.prototype._handleRetrieveResult=function(n,i){t.prototype._handleRetrieveResult.call(this,n,i);s(this,n,i)},i.newObject=function(t){return ot(n.AuthenticationService,t,"Microsoft.Authentication.AuthenticationService",!1,4)},Object.defineProperty(i.prototype,"onTokenReceived",{get:function(){var n=this;return k("AuthenticationService.onTokenReceived","FirstPartyAuthentication","1.2",p),this.m_tokenReceived||(this.m_tokenReceived=new OfficeExtension.GenericEventHandlers(this.context,this,"TokenReceived",{eventType:3001,registerFunc:function(){},unregisterFunc:function(){},getTargetIdFunc:function(){return n._targetId},eventArgsTransformFunc:function(n){var t={tokenValue:n.tokenValue,code:n.code};return OfficeExtension.Utility._createPromiseFromResult(t)}})),this.m_tokenReceived},enumerable:!0,configurable:!0}),i.prototype.toJSON=function(){return e(this,{},{})},i}(OfficeExtension.ClientObject);n.AuthenticationService=nt;y="RoamingSetting";tt=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),Object.defineProperty(u.prototype,"_className",{get:function(){return"RoamingSetting"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyNames",{get:function(){return["id","value"]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyUpdateable",{get:function(){return[!1,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"id",{get:function(){return i("id",this._I,y,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"value",{get:function(){return i("value",this._V,y,this._isNull),this._V},set:function(n){this._V=n;v(this,"Value",n,0)},enumerable:!0,configurable:!0}),u.prototype.set=function(n,t){this._recursivelySet(n,t,["value"],[],[])},u.prototype.update=function(n){this._recursivelyUpdate(n)},u.prototype._handleResult=function(i){if(n.prototype._handleResult.call(this,i),!r(i)){var u=i;o(this,u);t(u.Id)||(this._I=u.Id);t(u.Value)||(this._V=u.Value)}},u.prototype.load=function(n){return l(this,n)},u.prototype.retrieve=function(n){return a(this,n)},u.prototype._handleIdResult=function(i){(n.prototype._handleIdResult.call(this,i),r(i))||t(i.Id)||(this._I=i.Id)},u.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);s(this,t,i)},u.prototype.toJSON=function(){return e(this,{id:this._I,value:this._V},{})},u.prototype.ensureUnchanged=function(n){b(this,n);return},u}(OfficeExtension.ClientObject);n.RoamingSetting=tt;ct="RoamingSettingCollection";it=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"_className",{get:function(){return"RoamingSettingCollection"},enumerable:!0,configurable:!0}),i.prototype.getItem=function(t){return c(n.RoamingSetting,this,"GetItem",1,[t],!1,!1,null,4)},i.prototype.getItemOrNullObject=function(t){return c(n.RoamingSetting,this,"GetItemOrNullObject",1,[t],!1,!1,null,4)},i.prototype._handleResult=function(n){if(t.prototype._handleResult.call(this,n),!r(n)){var i=n;o(this,i)}},i.prototype._handleRetrieveResult=function(n,i){t.prototype._handleRetrieveResult.call(this,n,i);s(this,n,i)},i.prototype.toJSON=function(){return e(this,{},{})},i}(OfficeExtension.ClientObject);n.RoamingSettingCollection=it;u="Comment";rt=function(y){function p(){return y!==null&&y.apply(this,arguments)||this}return __extends(p,y),Object.defineProperty(p.prototype,"_className",{get:function(){return"Comment"},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"_scalarPropertyNames",{get:function(){return["id","text","created","level","resolved","author","mentions"]},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"_scalarPropertyUpdateable",{get:function(){return[!1,!0,!1,!1,!0,!1,!1]},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"_navigationPropertyNames",{get:function(){return["parent","parentOrNullObject","replies"]},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"parent",{get:function(){return this._P||(this._P=h(n.Comment,this,"Parent",!1,4)),this._P},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"parentOrNullObject",{get:function(){return this._Pa||(this._Pa=h(n.Comment,this,"ParentOrNullObject",!1,4)),this._Pa},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"replies",{get:function(){return this._R||(this._R=h(n.CommentCollection,this,"Replies",!0,4)),this._R},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"author",{get:function(){return i("author",this._A,u,this._isNull),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"created",{get:function(){return i("created",this._C,u,this._isNull),this._C},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"id",{get:function(){return i("id",this._I,u,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"level",{get:function(){return i("level",this._L,u,this._isNull),this._L},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"mentions",{get:function(){return i("mentions",this._M,u,this._isNull),this._M},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"resolved",{get:function(){return i("resolved",this._Re,u,this._isNull),this._Re},set:function(n){this._Re=n;v(this,"Resolved",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"text",{get:function(){return i("text",this._T,u,this._isNull),this._T},set:function(n){this._T=n;v(this,"Text",n,0)},enumerable:!0,configurable:!0}),p.prototype.set=function(n,t){this._recursivelySet(n,t,["text","resolved"],[],["parent","parentOrNullObject","replies"])},p.prototype.update=function(n){this._recursivelyUpdate(n)},p.prototype.delete=function(){f(this,"Delete",0,[],0,0)},p.prototype.getParentOrSelf=function(){return c(n.Comment,this,"GetParentOrSelf",1,[],!1,!1,null,4)},p.prototype.getRichText=function(n){return f(this,"GetRichText",1,[n],4,0)},p.prototype.reply=function(t,i){return c(n.Comment,this,"Reply",0,[t,i],!1,!1,null,0)},p.prototype.setRichText=function(n,t){return f(this,"SetRichText",0,[n,t],0,0)},p.prototype._handleResult=function(n){if(y.prototype._handleResult.call(this,n),!r(n)){var i=n;o(this,i);t(i.Author)||(this._A=i.Author);t(i.Created)||(this._C=g(i.Created));t(i.Id)||(this._I=i.Id);t(i.Level)||(this._L=i.Level);t(i.Mentions)||(this._M=i.Mentions);t(i.Resolved)||(this._Re=i.Resolved);t(i.Text)||(this._T=i.Text);d(this,i,["parent","Parent","parentOrNullObject","ParentOrNullObject","replies","Replies"])}},p.prototype.load=function(n){return l(this,n)},p.prototype.retrieve=function(n){return a(this,n)},p.prototype._handleIdResult=function(n){(y.prototype._handleIdResult.call(this,n),r(n))||t(n.Id)||(this._I=n.Id)},p.prototype._handleRetrieveResult=function(n,i){if(y.prototype._handleRetrieveResult.call(this,n,i),!r(n)){var u=n;t(u.Created)||(u.created=g(u.created));s(this,n,i)}},p.prototype.toJSON=function(){return e(this,{author:this._A,created:this._C,id:this._I,level:this._L,mentions:this._M,resolved:this._Re,text:this._T},{replies:this._R})},p.prototype.ensureUnchanged=function(n){b(this,n);return},p}(OfficeExtension.ClientObject);n.Comment=rt;ut="CommentCollection";ft=function(t){function u(){return t!==null&&t.apply(this,arguments)||this}return __extends(u,t),Object.defineProperty(u.prototype,"_className",{get:function(){return"CommentCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"items",{get:function(){return i("items",this.m__items,ut,this._isNull),this.m__items},enumerable:!0,configurable:!0}),u.prototype.getCount=function(){return f(this,"GetCount",1,[],4,0)},u.prototype.getItem=function(t){return et(n.Comment,this,[t])},u.prototype._handleResult=function(i){var f,e,u,s;if((t.prototype._handleResult.call(this,i),!r(i))&&(f=i,o(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)s=w(n.Comment,!0,this,e[u],u),s._handleResult(e[u]),this.m__items.push(s)},u.prototype.load=function(n){return l(this,n)},u.prototype.retrieve=function(n){return a(this,n)},u.prototype._handleRetrieveResult=function(i,r){var u=this;t.prototype._handleRetrieveResult.call(this,i,r);s(this,i,r,function(t,i){return w(n.Comment,!0,u,t,i)})},u.prototype.toJSON=function(){return e(this,{},{},this.m__items)},u}(OfficeExtension.ClientObject);n.CommentCollection=ft,function(n){n.plain="Plain";n.markdown="Markdown";n.delta="Delta"}(lt=n.CommentTextFormat||(n.CommentTextFormat={})),function(n){n.apiNotAvailable="ApiNotAvailable";n.clientError="ClientError";n.generalException="GeneralException";n.interactiveFlowAborted="InteractiveFlowAborted";n.invalidArgument="InvalidArgument";n.invalidGrant="InvalidGrant";n.invalidResourceUrl="InvalidResourceUrl";n.resourceNotSupported="ResourceNotSupported";n.serverError="ServerError";n.unsupportedUserIdentity="UnsupportedUserIdentity";n.userNotSignedIn="UserNotSignedIn"}(at=n.ErrorCodes||(n.ErrorCodes={}))}(OfficeCore||(OfficeCore={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var ai="Visio",vi="",c=OfficeExtension.BatchApiHelper.createPropertyObject,tt=OfficeExtension.BatchApiHelper.createMethodObject,p=OfficeExtension.BatchApiHelper.createIndexerObject,yi=OfficeExtension.BatchApiHelper.createRootServiceObject,pi=OfficeExtension.BatchApiHelper.createTopLevelServiceObject,a=OfficeExtension.BatchApiHelper.createChildItemObject,u=OfficeExtension.BatchApiHelper.invokeMethod,v=OfficeExtension.BatchApiHelper.invokeEnsureUnchanged,l=OfficeExtension.BatchApiHelper.invokeSetProperty,r=OfficeExtension.Utility.isNullOrUndefined,i=OfficeExtension.Utility.isUndefined,t=OfficeExtension.Utility.throwIfNotLoaded,wi=OfficeExtension.Utility.throwIfApiNotSupported,f=OfficeExtension.Utility.load,e=OfficeExtension.Utility.retrieve,o=OfficeExtension.Utility.toJson,s=OfficeExtension.Utility.fixObjectPathIfNecessary,g=OfficeExtension.Utility._handleNavigationPropertyResults,bi=OfficeExtension.Utility.adjustToDateTime,h=OfficeExtension.Utility.processRetrieveResult,it="Application",ui=function(n){function c(){return n!==null&&n.apply(this,arguments)||this}return __extends(c,n),Object.defineProperty(c.prototype,"_className",{get:function(){return"Application"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_scalarPropertyNames",{get:function(){return["showBorders","showToolbars"]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_scalarPropertyUpdateable",{get:function(){return[!0,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"showBorders",{get:function(){return t("showBorders",this._S,it,this._isNull),this._S},set:function(n){this._S=n;l(this,"ShowBorders",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"showToolbars",{get:function(){return t("showToolbars",this._Sh,it,this._isNull),this._Sh},set:function(n){this._Sh=n;l(this,"ShowToolbars",n,0)},enumerable:!0,configurable:!0}),c.prototype.set=function(n,t){this._recursivelySet(n,t,["showBorders","showToolbars"],[],[])},c.prototype.update=function(n){this._recursivelyUpdate(n)},c.prototype.showToolbar=function(n,t){u(this,"ShowToolbar",0,[n,t],0,0)},c.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!r(t)){var u=t;s(this,u);i(u.ShowBorders)||(this._S=u.ShowBorders);i(u.ShowToolbars)||(this._Sh=u.ShowToolbars)}},c.prototype.load=function(n){return f(this,n)},c.prototype.retrieve=function(n){return e(this,n)},c.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);h(this,t,i)},c.prototype.toJSON=function(){return o(this,{showBorders:this._S,showToolbars:this._Sh},{})},c.prototype.ensureUnchanged=function(n){v(this,n);return},c}(OfficeExtension.ClientObject),fi,rt,w,ut,y,ft,et,ot,st,ht,ct,lt,b,at,vt,yt,pt,wt,k,bt,kt,dt,d,gt,ni,ti,nt,ii,ei,ri,oi,si,hi,ci,li;n.Application=ui;fi="Document";rt=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"_className",{get:function(){return"Document"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_navigationPropertyNames",{get:function(){return["view","application","pages"]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"application",{get:function(){return this._A||(this._A=c(n.Application,this,"Application",!1,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pages",{get:function(){return this._P||(this._P=c(n.PageCollection,this,"Pages",!0,4)),this._P},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"view",{get:function(){return this._V||(this._V=c(n.DocumentView,this,"View",!1,4)),this._V},enumerable:!0,configurable:!0}),i.prototype.set=function(n,t){this._recursivelySet(n,t,[],["view","application"],["pages"])},i.prototype.update=function(n){this._recursivelyUpdate(n)},i.prototype.getActivePage=function(){return tt(n.Page,this,"GetActivePage",1,[],!1,!1,null,4)},i.prototype.setActivePage=function(n){u(this,"SetActivePage",1,[n],4,0)},i.prototype.startDataRefresh=function(){u(this,"StartDataRefresh",1,[],4,0)},i.prototype._handleResult=function(n){if(t.prototype._handleResult.call(this,n),!r(n)){var i=n;s(this,i);g(this,i,["application","Application","pages","Pages","view","View"])}},i.prototype.load=function(n){return f(this,n)},i.prototype.retrieve=function(n){return e(this,n)},i.prototype._handleRetrieveResult=function(n,i){t.prototype._handleRetrieveResult.call(this,n,i);h(this,n,i)},Object.defineProperty(i.prototype,"onDataRefreshComplete",{get:function(){var n=this;return this.m_dataRefreshComplete||(this.m_dataRefreshComplete=new OfficeExtension.EventHandlers(this.context,this,"DataRefreshComplete",{registerFunc:function(t){return n.context.eventRegistration.register(3,"",t)},unregisterFunc:function(t){return n.context.eventRegistration.unregister(3,"",t)},eventArgsTransformFunc:function(n){var t={document:this,success:n.ddaBinding.Object.success};return OfficeExtension.Utility._createPromiseFromResult(t)}})),this.m_dataRefreshComplete},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onDocumentLoadComplete",{get:function(){var n=this;return this.m_documentLoadComplete||(this.m_documentLoadComplete=new OfficeExtension.EventHandlers(this.context,this,"DocumentLoadComplete",{registerFunc:function(t){return n.context.eventRegistration.register(7,"",t)},unregisterFunc:function(t){return n.context.eventRegistration.unregister(7,"",t)},eventArgsTransformFunc:function(n){var t={success:n.ddaBinding.Object.success};return OfficeExtension.Utility._createPromiseFromResult(t)}})),this.m_documentLoadComplete},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onPageLoadComplete",{get:function(){var n=this;return this.m_pageLoadComplete||(this.m_pageLoadComplete=new OfficeExtension.EventHandlers(this.context,this,"PageLoadComplete",{registerFunc:function(t){return n.context.eventRegistration.register(1,"",t)},unregisterFunc:function(t){return n.context.eventRegistration.unregister(1,"",t)},eventArgsTransformFunc:function(n){return OfficeExtension.Utility._createPromiseFromResult(n.ddaBinding.Object)}})),this.m_pageLoadComplete},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onSelectionChanged",{get:function(){var n=this;return this.m_selectionChanged||(this.m_selectionChanged=new OfficeExtension.EventHandlers(this.context,this,"SelectionChanged",{registerFunc:function(t){return n.context.eventRegistration.register(2,"",t)},unregisterFunc:function(t){return n.context.eventRegistration.unregister(2,"",t)},eventArgsTransformFunc:function(n){return OfficeExtension.Utility._createPromiseFromResult(n.ddaBinding.Object)}})),this.m_selectionChanged},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onShapeMouseEnter",{get:function(){var n=this;return this.m_shapeMouseEnter||(this.m_shapeMouseEnter=new OfficeExtension.EventHandlers(this.context,this,"ShapeMouseEnter",{registerFunc:function(t){return n.context.eventRegistration.register(4,"",t)},unregisterFunc:function(t){return n.context.eventRegistration.unregister(4,"",t)},eventArgsTransformFunc:function(n){return OfficeExtension.Utility._createPromiseFromResult(n.ddaBinding.Object)}})),this.m_shapeMouseEnter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onShapeMouseLeave",{get:function(){var n=this;return this.m_shapeMouseLeave||(this.m_shapeMouseLeave=new OfficeExtension.EventHandlers(this.context,this,"ShapeMouseLeave",{registerFunc:function(t){return n.context.eventRegistration.register(5,"",t)},unregisterFunc:function(t){return n.context.eventRegistration.unregister(5,"",t)},eventArgsTransformFunc:function(n){return OfficeExtension.Utility._createPromiseFromResult(n.ddaBinding.Object)}})),this.m_shapeMouseLeave},enumerable:!0,configurable:!0}),i.prototype.toJSON=function(){return o(this,{},{application:this._A,pages:this._P,view:this._V})},i.prototype.ensureUnchanged=function(n){v(this,n);return},i}(OfficeExtension.ClientObject);n.Document=rt;w="DocumentView";ut=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),Object.defineProperty(u.prototype,"_className",{get:function(){return"DocumentView"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyNames",{get:function(){return["disableHyperlinks","disableZoom","disablePan","hideDiagramBoundary"]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyUpdateable",{get:function(){return[!0,!0,!0,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"disableHyperlinks",{get:function(){return t("disableHyperlinks",this._D,w,this._isNull),this._D},set:function(n){this._D=n;l(this,"DisableHyperlinks",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"disablePan",{get:function(){return t("disablePan",this._Di,w,this._isNull),this._Di},set:function(n){this._Di=n;l(this,"DisablePan",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"disableZoom",{get:function(){return t("disableZoom",this._Dis,w,this._isNull),this._Dis},set:function(n){this._Dis=n;l(this,"DisableZoom",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"hideDiagramBoundary",{get:function(){return t("hideDiagramBoundary",this._H,w,this._isNull),this._H},set:function(n){this._H=n;l(this,"HideDiagramBoundary",n,0)},enumerable:!0,configurable:!0}),u.prototype.set=function(n,t){this._recursivelySet(n,t,["disableHyperlinks","disableZoom","disablePan","hideDiagramBoundary"],[],[])},u.prototype.update=function(n){this._recursivelyUpdate(n)},u.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!r(t)){var u=t;s(this,u);i(u.DisableHyperlinks)||(this._D=u.DisableHyperlinks);i(u.DisablePan)||(this._Di=u.DisablePan);i(u.DisableZoom)||(this._Dis=u.DisableZoom);i(u.HideDiagramBoundary)||(this._H=u.HideDiagramBoundary)}},u.prototype.load=function(n){return f(this,n)},u.prototype.retrieve=function(n){return e(this,n)},u.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);h(this,t,i)},u.prototype.toJSON=function(){return o(this,{disableHyperlinks:this._D,disablePan:this._Di,disableZoom:this._Dis,hideDiagramBoundary:this._H},{})},u.prototype.ensureUnchanged=function(n){v(this,n);return},u}(OfficeExtension.ClientObject);n.DocumentView=ut;y="Page";ft=function(l){function a(){return l!==null&&l.apply(this,arguments)||this}return __extends(a,l),Object.defineProperty(a.prototype,"_className",{get:function(){return"Page"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyNames",{get:function(){return["index","name","isBackground","width","height"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_navigationPropertyNames",{get:function(){return["shapes","view","comments","allShapes"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"allShapes",{get:function(){return this._A||(this._A=c(n.ShapeCollection,this,"AllShapes",!0,4)),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"comments",{get:function(){return this._C||(this._C=c(n.CommentCollection,this,"Comments",!0,4)),this._C},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"shapes",{get:function(){return this._S||(this._S=c(n.ShapeCollection,this,"Shapes",!0,4)),this._S},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"view",{get:function(){return this._V||(this._V=c(n.PageView,this,"View",!1,4)),this._V},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return t("height",this._H,y,this._isNull),this._H},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"index",{get:function(){return t("index",this._I,y,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isBackground",{get:function(){return t("isBackground",this._Is,y,this._isNull),this._Is},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return t("name",this._N,y,this._isNull),this._N},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return t("width",this._W,y,this._isNull),this._W},enumerable:!0,configurable:!0}),a.prototype.set=function(n,t){this._recursivelySet(n,t,[],["view"],["allShapes","comments","shapes"])},a.prototype.update=function(n){this._recursivelyUpdate(n)},a.prototype.activate=function(){u(this,"Activate",1,[],4,0)},a.prototype._handleResult=function(n){if(l.prototype._handleResult.call(this,n),!r(n)){var t=n;s(this,t);i(t.Height)||(this._H=t.Height);i(t.Index)||(this._I=t.Index);i(t.IsBackground)||(this._Is=t.IsBackground);i(t.Name)||(this._N=t.Name);i(t.Width)||(this._W=t.Width);g(this,t,["allShapes","AllShapes","comments","Comments","shapes","Shapes","view","View"])}},a.prototype.load=function(n){return f(this,n)},a.prototype.retrieve=function(n){return e(this,n)},a.prototype._handleRetrieveResult=function(n,t){l.prototype._handleRetrieveResult.call(this,n,t);h(this,n,t)},a.prototype.toJSON=function(){return o(this,{height:this._H,index:this._I,isBackground:this._Is,name:this._N,width:this._W},{allShapes:this._A,comments:this._C,shapes:this._S,view:this._V})},a.prototype.ensureUnchanged=function(n){v(this,n);return},a}(OfficeExtension.ClientObject);n.Page=ft;et="PageView";ot=function(c){function a(){return c!==null&&c.apply(this,arguments)||this}return __extends(a,c),Object.defineProperty(a.prototype,"_className",{get:function(){return"PageView"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyNames",{get:function(){return["zoom"]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"_scalarPropertyUpdateable",{get:function(){return[!0]},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"zoom",{get:function(){return t("zoom",this._Z,et,this._isNull),this._Z},set:function(n){this._Z=n;l(this,"Zoom",n,0)},enumerable:!0,configurable:!0}),a.prototype.set=function(n,t){this._recursivelySet(n,t,["zoom"],[],[])},a.prototype.update=function(n){this._recursivelyUpdate(n)},a.prototype.centerViewportOnShape=function(n){u(this,"CenterViewportOnShape",1,[n],4,0)},a.prototype.fitToWindow=function(){u(this,"FitToWindow",1,[],4,0)},a.prototype.getPosition=function(){return u(this,"GetPosition",1,[],4,0)},a.prototype.getSelection=function(){return tt(n.Selection,this,"GetSelection",1,[],!1,!1,null,4)},a.prototype.isShapeInViewport=function(n){return u(this,"IsShapeInViewport",1,[n],4,0)},a.prototype.setPosition=function(n){u(this,"SetPosition",1,[n],4,0)},a.prototype._handleResult=function(n){if(c.prototype._handleResult.call(this,n),!r(n)){var t=n;s(this,t);i(t.Zoom)||(this._Z=t.Zoom)}},a.prototype.load=function(n){return f(this,n)},a.prototype.retrieve=function(n){return e(this,n)},a.prototype._handleRetrieveResult=function(n,t){c.prototype._handleRetrieveResult.call(this,n,t);h(this,n,t)},a.prototype.toJSON=function(){return o(this,{zoom:this._Z},{})},a.prototype.ensureUnchanged=function(n){v(this,n);return},a}(OfficeExtension.ClientObject);n.PageView=ot;st="PageCollection";ht=function(i){function c(){return i!==null&&i.apply(this,arguments)||this}return __extends(c,i),Object.defineProperty(c.prototype,"_className",{get:function(){return"PageCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"items",{get:function(){return t("items",this.m__items,st,this._isNull),this.m__items},enumerable:!0,configurable:!0}),c.prototype.getCount=function(){return u(this,"GetCount",1,[],4,0)},c.prototype.getItem=function(t){return p(n.Page,this,[t])},c.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,s(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=a(n.Page,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},c.prototype.load=function(n){return f(this,n)},c.prototype.retrieve=function(n){return e(this,n)},c.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);h(this,t,r,function(t,i){return a(n.Page,!0,u,t,i)})},c.prototype.toJSON=function(){return o(this,{},{},this.m__items)},c}(OfficeExtension.ClientObject);n.PageCollection=ht;ct="ShapeCollection";lt=function(i){function c(){return i!==null&&i.apply(this,arguments)||this}return __extends(c,i),Object.defineProperty(c.prototype,"_className",{get:function(){return"ShapeCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"items",{get:function(){return t("items",this.m__items,ct,this._isNull),this.m__items},enumerable:!0,configurable:!0}),c.prototype.getCount=function(){return u(this,"GetCount",1,[],4,0)},c.prototype.getItem=function(t){return p(n.Shape,this,[t])},c.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,s(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=a(n.Shape,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},c.prototype.load=function(n){return f(this,n)},c.prototype.retrieve=function(n){return e(this,n)},c.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);h(this,t,r,function(t,i){return a(n.Shape,!0,u,t,i)})},c.prototype.toJSON=function(){return o(this,{},{},this.m__items)},c}(OfficeExtension.ClientObject);n.ShapeCollection=lt;b="Shape";at=function(a){function y(){return a!==null&&a.apply(this,arguments)||this}return __extends(y,a),Object.defineProperty(y.prototype,"_className",{get:function(){return"Shape"},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"_scalarPropertyNames",{get:function(){return["name","id","text","select"]},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"_scalarPropertyUpdateable",{get:function(){return[!1,!1,!1,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"_navigationPropertyNames",{get:function(){return["hyperlinks","shapeDataItems","view","subShapes","comments"]},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"comments",{get:function(){return this._C||(this._C=c(n.CommentCollection,this,"Comments",!0,4)),this._C},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"hyperlinks",{get:function(){return this._H||(this._H=c(n.HyperlinkCollection,this,"Hyperlinks",!0,4)),this._H},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"shapeDataItems",{get:function(){return this._Sh||(this._Sh=c(n.ShapeDataItemCollection,this,"ShapeDataItems",!0,4)),this._Sh},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"subShapes",{get:function(){return this._Su||(this._Su=c(n.ShapeCollection,this,"SubShapes",!0,4)),this._Su},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"view",{get:function(){return this._V||(this._V=c(n.ShapeView,this,"View",!1,4)),this._V},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"id",{get:function(){return t("id",this._I,b,this._isNull),this._I},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"name",{get:function(){return t("name",this._N,b,this._isNull),this._N},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"select",{get:function(){return t("select",this._S,b,this._isNull),this._S},set:function(n){this._S=n;l(this,"Select",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"text",{get:function(){return t("text",this._T,b,this._isNull),this._T},enumerable:!0,configurable:!0}),y.prototype.set=function(n,t){this._recursivelySet(n,t,["select"],["view"],["comments","hyperlinks","shapeDataItems","subShapes"])},y.prototype.update=function(n){this._recursivelyUpdate(n)},y.prototype.getBounds=function(){return u(this,"GetBounds",1,[],4,0)},y.prototype._handleResult=function(n){if(a.prototype._handleResult.call(this,n),!r(n)){var t=n;s(this,t);i(t.Id)||(this._I=t.Id);i(t.Name)||(this._N=t.Name);i(t.Select)||(this._S=t.Select);i(t.Text)||(this._T=t.Text);g(this,t,["comments","Comments","hyperlinks","Hyperlinks","shapeDataItems","ShapeDataItems","subShapes","SubShapes","view","View"])}},y.prototype.load=function(n){return f(this,n)},y.prototype.retrieve=function(n){return e(this,n)},y.prototype._handleIdResult=function(n){(a.prototype._handleIdResult.call(this,n),r(n))||i(n.Id)||(this._I=n.Id)},y.prototype._handleRetrieveResult=function(n,t){a.prototype._handleRetrieveResult.call(this,n,t);h(this,n,t)},y.prototype.toJSON=function(){return o(this,{id:this._I,name:this._N,select:this._S,text:this._T},{comments:this._C,hyperlinks:this._H,shapeDataItems:this._Sh,subShapes:this._Su,view:this._V})},y.prototype.ensureUnchanged=function(n){v(this,n);return},y}(OfficeExtension.ClientObject);n.Shape=at;vt="ShapeView";yt=function(n){function c(){return n!==null&&n.apply(this,arguments)||this}return __extends(c,n),Object.defineProperty(c.prototype,"_className",{get:function(){return"ShapeView"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_scalarPropertyNames",{get:function(){return["highlight"]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_scalarPropertyUpdateable",{get:function(){return[!0]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"highlight",{get:function(){return t("highlight",this._H,vt,this._isNull),this._H},set:function(n){this._H=n;l(this,"Highlight",n,0)},enumerable:!0,configurable:!0}),c.prototype.set=function(n,t){this._recursivelySet(n,t,["highlight"],[],[])},c.prototype.update=function(n){this._recursivelyUpdate(n)},c.prototype.addOverlay=function(n,t,i,r,f,e){return u(this,"AddOverlay",1,[n,t,i,r,f,e],4,0)},c.prototype.removeOverlay=function(n){u(this,"RemoveOverlay",1,[n],4,0)},c.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!r(t)){var u=t;s(this,u);i(u.Highlight)||(this._H=u.Highlight)}},c.prototype.load=function(n){return f(this,n)},c.prototype.retrieve=function(n){return e(this,n)},c.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);h(this,t,i)},c.prototype.toJSON=function(){return o(this,{highlight:this._H},{})},c.prototype.ensureUnchanged=function(n){v(this,n);return},c}(OfficeExtension.ClientObject);n.ShapeView=yt;pt="ShapeDataItemCollection";wt=function(i){function c(){return i!==null&&i.apply(this,arguments)||this}return __extends(c,i),Object.defineProperty(c.prototype,"_className",{get:function(){return"ShapeDataItemCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"items",{get:function(){return t("items",this.m__items,pt,this._isNull),this.m__items},enumerable:!0,configurable:!0}),c.prototype.getCount=function(){return u(this,"GetCount",1,[],4,0)},c.prototype.getItem=function(t){return p(n.ShapeDataItem,this,[t])},c.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,s(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=a(n.ShapeDataItem,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},c.prototype.load=function(n){return f(this,n)},c.prototype.retrieve=function(n){return e(this,n)},c.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);h(this,t,r,function(t,i){return a(n.ShapeDataItem,!0,u,t,i)})},c.prototype.toJSON=function(){return o(this,{},{},this.m__items)},c}(OfficeExtension.ClientObject);n.ShapeDataItemCollection=wt;k="ShapeDataItem";bt=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),Object.defineProperty(u.prototype,"_className",{get:function(){return"ShapeDataItem"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyNames",{get:function(){return["label","value","format","formattedValue"]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"format",{get:function(){return t("format",this._F,k,this._isNull),this._F},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"formattedValue",{get:function(){return t("formattedValue",this._Fo,k,this._isNull),this._Fo},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"label",{get:function(){return t("label",this._L,k,this._isNull),this._L},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"value",{get:function(){return t("value",this._V,k,this._isNull),this._V},enumerable:!0,configurable:!0}),u.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!r(t)){var u=t;s(this,u);i(u.Format)||(this._F=u.Format);i(u.FormattedValue)||(this._Fo=u.FormattedValue);i(u.Label)||(this._L=u.Label);i(u.Value)||(this._V=u.Value)}},u.prototype.load=function(n){return f(this,n)},u.prototype.retrieve=function(n){return e(this,n)},u.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);h(this,t,i)},u.prototype.toJSON=function(){return o(this,{format:this._F,formattedValue:this._Fo,label:this._L,value:this._V},{})},u.prototype.ensureUnchanged=function(n){v(this,n);return},u}(OfficeExtension.ClientObject);n.ShapeDataItem=bt;kt="HyperlinkCollection";dt=function(i){function c(){return i!==null&&i.apply(this,arguments)||this}return __extends(c,i),Object.defineProperty(c.prototype,"_className",{get:function(){return"HyperlinkCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"items",{get:function(){return t("items",this.m__items,kt,this._isNull),this.m__items},enumerable:!0,configurable:!0}),c.prototype.getCount=function(){return u(this,"GetCount",1,[],4,0)},c.prototype.getItem=function(t){return p(n.Hyperlink,this,[t])},c.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,s(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=a(n.Hyperlink,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},c.prototype.load=function(n){return f(this,n)},c.prototype.retrieve=function(n){return e(this,n)},c.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);h(this,t,r,function(t,i){return a(n.Hyperlink,!0,u,t,i)})},c.prototype.toJSON=function(){return o(this,{},{},this.m__items)},c}(OfficeExtension.ClientObject);n.HyperlinkCollection=dt;d="Hyperlink";gt=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),Object.defineProperty(u.prototype,"_className",{get:function(){return"Hyperlink"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyNames",{get:function(){return["address","subAddress","description","extraInfo"]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"address",{get:function(){return t("address",this._A,d,this._isNull),this._A},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"description",{get:function(){return t("description",this._D,d,this._isNull),this._D},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"extraInfo",{get:function(){return t("extraInfo",this._E,d,this._isNull),this._E},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"subAddress",{get:function(){return t("subAddress",this._S,d,this._isNull),this._S},enumerable:!0,configurable:!0}),u.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!r(t)){var u=t;s(this,u);i(u.Address)||(this._A=u.Address);i(u.Description)||(this._D=u.Description);i(u.ExtraInfo)||(this._E=u.ExtraInfo);i(u.SubAddress)||(this._S=u.SubAddress)}},u.prototype.load=function(n){return f(this,n)},u.prototype.retrieve=function(n){return e(this,n)},u.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);h(this,t,i)},u.prototype.toJSON=function(){return o(this,{address:this._A,description:this._D,extraInfo:this._E,subAddress:this._S},{})},u.prototype.ensureUnchanged=function(n){v(this,n);return},u}(OfficeExtension.ClientObject);n.Hyperlink=gt;ni="CommentCollection";ti=function(i){function c(){return i!==null&&i.apply(this,arguments)||this}return __extends(c,i),Object.defineProperty(c.prototype,"_className",{get:function(){return"CommentCollection"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"_isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"items",{get:function(){return t("items",this.m__items,ni,this._isNull),this.m__items},enumerable:!0,configurable:!0}),c.prototype.getCount=function(){return u(this,"GetCount",1,[],4,0)},c.prototype.getItem=function(t){return p(n.Comment,this,[t])},c.prototype._handleResult=function(t){var f,e,u,o;if((i.prototype._handleResult.call(this,t),!r(t))&&(f=t,s(this,f),!r(f[OfficeExtension.Constants.items])))for(this.m__items=[],e=f[OfficeExtension.Constants.items],u=0;u<e.length;u++)o=a(n.Comment,!0,this,e[u],u),o._handleResult(e[u]),this.m__items.push(o)},c.prototype.load=function(n){return f(this,n)},c.prototype.retrieve=function(n){return e(this,n)},c.prototype._handleRetrieveResult=function(t,r){var u=this;i.prototype._handleRetrieveResult.call(this,t,r);h(this,t,r,function(t,i){return a(n.Comment,!0,u,t,i)})},c.prototype.toJSON=function(){return o(this,{},{},this.m__items)},c}(OfficeExtension.ClientObject);n.CommentCollection=ti;nt="Comment";ii=function(n){function u(){return n!==null&&n.apply(this,arguments)||this}return __extends(u,n),Object.defineProperty(u.prototype,"_className",{get:function(){return"Comment"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyNames",{get:function(){return["author","text","date"]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_scalarPropertyUpdateable",{get:function(){return[!0,!0,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"author",{get:function(){return t("author",this._A,nt,this._isNull),this._A},set:function(n){this._A=n;l(this,"Author",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"date",{get:function(){return t("date",this._D,nt,this._isNull),this._D},set:function(n){this._D=n;l(this,"Date",n,0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"text",{get:function(){return t("text",this._T,nt,this._isNull),this._T},set:function(n){this._T=n;l(this,"Text",n,0)},enumerable:!0,configurable:!0}),u.prototype.set=function(n,t){this._recursivelySet(n,t,["author","text","date"],[],[])},u.prototype.update=function(n){this._recursivelyUpdate(n)},u.prototype._handleResult=function(t){if(n.prototype._handleResult.call(this,t),!r(t)){var u=t;s(this,u);i(u.Author)||(this._A=u.Author);i(u.Date)||(this._D=u.Date);i(u.Text)||(this._T=u.Text)}},u.prototype.load=function(n){return f(this,n)},u.prototype.retrieve=function(n){return e(this,n)},u.prototype._handleRetrieveResult=function(t,i){n.prototype._handleRetrieveResult.call(this,t,i);h(this,t,i)},u.prototype.toJSON=function(){return o(this,{author:this._A,date:this._D,text:this._T},{})},u.prototype.ensureUnchanged=function(n){v(this,n);return},u}(OfficeExtension.ClientObject);n.Comment=ii;ei="Selection";ri=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"_className",{get:function(){return"Selection"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_navigationPropertyNames",{get:function(){return["shapes"]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shapes",{get:function(){return this._S||(this._S=c(n.ShapeCollection,this,"Shapes",!0,4)),this._S},enumerable:!0,configurable:!0}),i.prototype._handleResult=function(n){if(t.prototype._handleResult.call(this,n),!r(n)){var i=n;s(this,i);g(this,i,["shapes","Shapes"])}},i.prototype.load=function(n){return f(this,n)},i.prototype.retrieve=function(n){return e(this,n)},i.prototype._handleRetrieveResult=function(n,i){t.prototype._handleRetrieveResult.call(this,n,i);h(this,n,i)},i.prototype.toJSON=function(){return o(this,{},{shapes:this._S})},i}(OfficeExtension.ClientObject);n.Selection=ri,function(n){n.left="Left";n.center="Center";n.right="Right"}(oi=n.OverlayHorizontalAlignment||(n.OverlayHorizontalAlignment={})),function(n){n.top="Top";n.middle="Middle";n.bottom="Bottom"}(si=n.OverlayVerticalAlignment||(n.OverlayVerticalAlignment={})),function(n){n.text="Text";n.image="Image"}(hi=n.OverlayType||(n.OverlayType={})),function(n){n.commandBar="CommandBar";n.pageNavigationBar="PageNavigationBar";n.statusBar="StatusBar"}(ci=n.ToolBarType||(n.ToolBarType={})),function(n){n.accessDenied="AccessDenied";n.generalException="GeneralException";n.invalidArgument="InvalidArgument";n.itemNotFound="ItemNotFound";n.notImplemented="NotImplemented";n.unsupportedOperation="UnsupportedOperation"}(li=n.ErrorCodes||(n.ErrorCodes={}))}(Visio||(Visio={}));Object.defineProperty(OfficeExtension.SessionBase,"_overrideSession",{get:function(){return this._overrideSessionInternal?this._overrideSessionInternal:OfficeExtension.ClientRequestContext?OfficeExtension.ClientRequestContext._overrideSession:undefined},set:function(n){this._overrideSessionInternal=n},enumerable:!0,configurable:!0}),function(n){function i(t,i,r){return OfficeExtension.ClientRequestContext._runBatch("Visio.run",arguments,function(t){return new n.RequestContext(t)})}var t=function(t){function i(i){var r=t.call(this,i)||this;return r.m_document=new n.Document(r,OfficeExtension.ObjectPathFactory.createGlobalObjectObjectPath(r)),r._rootObject=r.m_document,r}return __extends(i,t),Object.defineProperty(i.prototype,"document",{get:function(){return this.m_document},enumerable:!0,configurable:!0}),i}(OfficeExtension.ClientRequestContext);n.RequestContext=t;n.run=i}(Visio||(Visio={}))